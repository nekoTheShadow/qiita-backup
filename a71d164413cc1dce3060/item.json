{"rendered_body":"<p>ダウンロード処理をJavaScriptで実装する場合、言い換えればBlobオブジェクトをローカルストレージに保存する処理をJavaScriptで制御する場合、IE11では<code>window.navigator.msSaveBlob</code>と<code>window.navigator.msSaveOrOpenBlob</code>というふたつのAPIが用意されています。このふたつのAPIの違いですが、呼び出した際に表示されるポップアップが異なります。たとえば以下のようなhtmlファイルを用意します。</p>\n\n<div class=\"code-frame\" data-lang=\"html\"><div class=\"highlight\"><pre><span class=\"cp\">&lt;!DOCTYPE html&gt;</span>\n<span class=\"nt\">&lt;html&gt;</span>\n  <span class=\"nt\">&lt;body&gt;</span>\n    <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">'button'</span> <span class=\"na\">value=</span><span class=\"s\">'msSaveBlob'</span> <span class=\"na\">id=</span><span class=\"s\">'msSaveBlob'</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">'button'</span> <span class=\"na\">value=</span><span class=\"s\">'msSaveOrOpenBlob'</span> <span class=\"na\">id=</span><span class=\"s\">'msSaveOrOpenBlob'</span> <span class=\"nt\">/&gt;</span>\n  <span class=\"nt\">&lt;/body&gt;</span>\n\n  <span class=\"nt\">&lt;script&gt;</span>\n    <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">onload</span> <span class=\"o\">=</span> <span class=\"kd\">function</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n      <span class=\"kd\">var</span> <span class=\"nx\">blob</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nx\">Blob</span><span class=\"p\">([</span><span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nx\">stringify</span><span class=\"p\">({</span><span class=\"na\">hello</span> <span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">world</span><span class=\"dl\">'</span><span class=\"p\">})],</span> <span class=\"p\">{</span><span class=\"na\">type</span> <span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">application/json</span><span class=\"dl\">'</span><span class=\"p\">});</span>\n\n      <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">getElementById</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">msSaveBlob</span><span class=\"dl\">'</span><span class=\"p\">).</span><span class=\"nx\">addEventListener</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">click</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">){</span>\n        <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nb\">navigator</span><span class=\"p\">.</span><span class=\"nx\">msSaveBlob</span><span class=\"p\">(</span><span class=\"nx\">blob</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">msSaveBlob.json</span><span class=\"dl\">'</span><span class=\"p\">)</span>\n      <span class=\"p\">});</span>\n\n      <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">getElementById</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">msSaveOrOpenBlob</span><span class=\"dl\">'</span><span class=\"p\">).</span><span class=\"nx\">addEventListener</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">click</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">){</span>\n        <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nb\">navigator</span><span class=\"p\">.</span><span class=\"nx\">msSaveOrOpenBlob</span><span class=\"p\">(</span><span class=\"nx\">blob</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">msSaveOrOpenBlob.json</span><span class=\"dl\">'</span><span class=\"p\">)</span>\n      <span class=\"p\">});</span>\n    <span class=\"p\">}</span>\n  <span class=\"nt\">&lt;/script&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n\n</pre></div></div>\n\n<p>これをファイルに保存したのち、IE11で開いてみると以下のような画面が表示されるはずです。なお一部にローカルパスが表示されているので黒塗りにしています。見えても特に害はないはずですが、なんとなく恥ずかしいので隠しました(´・ω・｀)</p>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2Fb79a6cd5-1b66-df10-7d01-fc07f54d3931.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=313860dc27278c07d061685f3c770d3b\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2Fb79a6cd5-1b66-df10-7d01-fc07f54d3931.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=313860dc27278c07d061685f3c770d3b\" alt=\"キャプチャ - コピー.PNG\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/105859/b79a6cd5-1b66-df10-7d01-fc07f54d3931.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2Fb79a6cd5-1b66-df10-7d01-fc07f54d3931.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b06ec825fccbe7f8a7f7c6e37a812d0c 1x\" loading=\"lazy\"></a></p>\n\n<p>このうちmsSaveBlobボタンを押下する、すなわち<code>msSaveBlob</code>を呼び出すと以下のようなポップアップが表示されるはずです。</p>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2Fc742787d-db3f-c965-6daf-fae37da874e8.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8e8290f8ef184f39ccaada966882488b\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2Fc742787d-db3f-c965-6daf-fae37da874e8.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8e8290f8ef184f39ccaada966882488b\" alt=\"キャプチャ1 - コピー.PNG\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/105859/c742787d-db3f-c965-6daf-fae37da874e8.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2Fc742787d-db3f-c965-6daf-fae37da874e8.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=fbc16a6f40c3155cb6c741ad71706874 1x\" loading=\"lazy\"></a></p>\n\n<p>次にmsSaveOrOpenBlobボタンを押下して、<code>msSaveOrOpenBlob</code>を呼び出した場合は次のようなポップアップが表示されると思います。</p>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2F2d302795-a2c1-6db9-6d16-bc630ea8fe35.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=71b062861f51f0274e31e7ac5097c555\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2F2d302795-a2c1-6db9-6d16-bc630ea8fe35.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=71b062861f51f0274e31e7ac5097c555\" alt=\"キャプチャ3 - コピー.PNG\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/105859/2d302795-a2c1-6db9-6d16-bc630ea8fe35.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2F2d302795-a2c1-6db9-6d16-bc630ea8fe35.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=4c14dd7f937ff5f469681b1e239ec589 1x\" loading=\"lazy\"></a></p>\n\n<p>つまり<code>msSaveBlob</code>の場合はダウンロードファイルをローカルに保存するだけ、一方<code>msSaveOrOpenBlob</code>の場合は保存せずにファイルを開くことが可能になります。<strong>ふたつのAPIがある理由はいろいろ調べたもののよくわからなったのですが、現代的なIE11プログラミング(?)では特別な理由がない限り、基本的には<code>msSaveOrOpenBlob</code>を利用するのがよさそうです。</strong></p>\n","body":"ダウンロード処理をJavaScriptで実装する場合、言い換えればBlobオブジェクトをローカルストレージに保存する処理をJavaScriptで制御する場合、IE11では`window.navigator.msSaveBlob`と`window.navigator.msSaveOrOpenBlob`というふたつのAPIが用意されています。このふたつのAPIの違いですが、呼び出した際に表示されるポップアップが異なります。たとえば以下のようなhtmlファイルを用意します。\n\n```html\n<!DOCTYPE html>\n<html>\n  <body>\n    <input type='button' value='msSaveBlob' id='msSaveBlob' />\n    <input type='button' value='msSaveOrOpenBlob' id='msSaveOrOpenBlob' />\n  </body>\n\n  <script>\n    window.onload = function() {\n      var blob = new Blob([JSON.stringify({hello : 'world'})], {type : 'application/json'});\n\n      document.getElementById('msSaveBlob').addEventListener('click', function(e){\n        window.navigator.msSaveBlob(blob, 'msSaveBlob.json')\n      });\n\n      document.getElementById('msSaveOrOpenBlob').addEventListener('click', function(e){\n        window.navigator.msSaveOrOpenBlob(blob, 'msSaveOrOpenBlob.json')\n      });\n    }\n  </script>\n</html>\n\n```\n\nこれをファイルに保存したのち、IE11で開いてみると以下のような画面が表示されるはずです。なお一部にローカルパスが表示されているので黒塗りにしています。見えても特に害はないはずですが、なんとなく恥ずかしいので隠しました(´・ω・｀)\n\n![キャプチャ - コピー.PNG](https://qiita-image-store.s3.amazonaws.com/0/105859/b79a6cd5-1b66-df10-7d01-fc07f54d3931.png)\n\nこのうちmsSaveBlobボタンを押下する、すなわち`msSaveBlob`を呼び出すと以下のようなポップアップが表示されるはずです。\n\n![キャプチャ1 - コピー.PNG](https://qiita-image-store.s3.amazonaws.com/0/105859/c742787d-db3f-c965-6daf-fae37da874e8.png)\n\n次にmsSaveOrOpenBlobボタンを押下して、`msSaveOrOpenBlob`を呼び出した場合は次のようなポップアップが表示されると思います。\n\n![キャプチャ3 - コピー.PNG](https://qiita-image-store.s3.amazonaws.com/0/105859/2d302795-a2c1-6db9-6d16-bc630ea8fe35.png)\n\nつまり`msSaveBlob`の場合はダウンロードファイルをローカルに保存するだけ、一方`msSaveOrOpenBlob`の場合は保存せずにファイルを開くことが可能になります。__ふたつのAPIがある理由はいろいろ調べたもののよくわからなったのですが、現代的なIE11プログラミング(?)では特別な理由がない限り、基本的には`msSaveOrOpenBlob`を利用するのがよさそうです。__\n","coediting":false,"comments_count":0,"created_at":"2018-03-13T22:58:47+09:00","group":null,"id":"a71d164413cc1dce3060","likes_count":10,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"IE11","versions":[]}],"title":"IE11にはファイルをローカルに保存するJavaScriptのAPIが2種類用意されている。","updated_at":"2018-03-13T22:58:47+09:00","url":"https://qiita.com/neko_the_shadow/items/a71d164413cc1dce3060","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":35,"github_login_name":null,"id":"neko_the_shadow","items_count":179,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null}