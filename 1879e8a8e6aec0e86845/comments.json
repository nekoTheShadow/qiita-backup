[{"body":"@saka1029 \n\nコメントありがとうございます。\n\nたとえば「初回起動時には外部ファイルの値をフィールドに設定し、2回目以降は設定された値を使いまわす」というように、__初回とそれ以降の挙動を変えるという状況を想定していました__。つまりフィールドがnullかどうかを見て、初回か否かを判定していたつもりでしたが、setterの引数にnullが与えられたときのことは考慮からもれていました･･････。\n\n対策としては以下のうちのひとつ、もしくは複数を状況に合わせて組み合わせることになると思います。\n\n- static initializerを使う\n- 初回かどうかを判定するboolean fieldを作成する。\n- setterにnullチェックをくわえる\n- そもそもsetterを用意しない\n- fieldをnull以外により初期化する\n\nサンプルコードということで油断していました･･････。精進します(´・ω・｀)\n","created_at":"2017-06-05T12:54:30+09:00","id":"3a3237ec0d5e8f70c03a","rendered_body":"<p><a href=\"/saka1029\" class=\"user-mention js-hovercard\" title=\"saka1029\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"saka1029\">@saka1029</a> </p>\n\n<p>コメントありがとうございます。</p>\n\n<p>たとえば「初回起動時には外部ファイルの値をフィールドに設定し、2回目以降は設定された値を使いまわす」というように、<strong>初回とそれ以降の挙動を変えるという状況を想定していました</strong>。つまりフィールドがnullかどうかを見て、初回か否かを判定していたつもりでしたが、setterの引数にnullが与えられたときのことは考慮からもれていました･･････。</p>\n\n<p>対策としては以下のうちのひとつ、もしくは複数を状況に合わせて組み合わせることになると思います。</p>\n\n<ul>\n<li>static initializerを使う</li>\n<li>初回かどうかを判定するboolean fieldを作成する。</li>\n<li>setterにnullチェックをくわえる</li>\n<li>そもそもsetterを用意しない</li>\n<li>fieldをnull以外により初期化する</li>\n</ul>\n\n<p>サンプルコードということで油断していました･･････。精進します(´・ω・｀)</p>\n","updated_at":"2017-06-05T12:54:30+09:00","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":35,"github_login_name":null,"id":"neko_the_shadow","items_count":210,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"}},{"body":"nullをセットすると初期値に戻るというのはおかしい気がします。\n\n```java\nSingleton instance1 = Singleton.getInstance();\nSystem.out.println(instance1.getField()); //=> field\ninstance1.setField(null);\nSystem.out.println(instance1.getField()); //=> null\nSingleton instance2 = Singleton.getInstance();\nSystem.out.println(instance2.getField()); //=> field\n```\n\nこれでいいのでは？\n\n```java\npublic enum Singleton {\n\n    INSTANCE;\n\n    private String field = \"field\";\n\n    public String getField() {\n        return field;\n    }\n\n    public void setField(String field) {\n        this.field = field;\n    }\n}\n```\n","created_at":"2017-06-05T09:25:56+09:00","id":"43083f2f125ae474b444","rendered_body":"<p>nullをセットすると初期値に戻るというのはおかしい気がします。</p>\n\n<div class=\"code-frame\" data-lang=\"java\"><div class=\"highlight\"><pre><code><span class=\"nc\">Singleton</span> <span class=\"n\">instance1</span> <span class=\"o\">=</span> <span class=\"nc\">Singleton</span><span class=\"o\">.</span><span class=\"na\">getInstance</span><span class=\"o\">();</span>\n<span class=\"nc\">System</span><span class=\"o\">.</span><span class=\"na\">out</span><span class=\"o\">.</span><span class=\"na\">println</span><span class=\"o\">(</span><span class=\"n\">instance1</span><span class=\"o\">.</span><span class=\"na\">getField</span><span class=\"o\">());</span> <span class=\"c1\">//=&gt; field</span>\n<span class=\"n\">instance1</span><span class=\"o\">.</span><span class=\"na\">setField</span><span class=\"o\">(</span><span class=\"kc\">null</span><span class=\"o\">);</span>\n<span class=\"nc\">System</span><span class=\"o\">.</span><span class=\"na\">out</span><span class=\"o\">.</span><span class=\"na\">println</span><span class=\"o\">(</span><span class=\"n\">instance1</span><span class=\"o\">.</span><span class=\"na\">getField</span><span class=\"o\">());</span> <span class=\"c1\">//=&gt; null</span>\n<span class=\"nc\">Singleton</span> <span class=\"n\">instance2</span> <span class=\"o\">=</span> <span class=\"nc\">Singleton</span><span class=\"o\">.</span><span class=\"na\">getInstance</span><span class=\"o\">();</span>\n<span class=\"nc\">System</span><span class=\"o\">.</span><span class=\"na\">out</span><span class=\"o\">.</span><span class=\"na\">println</span><span class=\"o\">(</span><span class=\"n\">instance2</span><span class=\"o\">.</span><span class=\"na\">getField</span><span class=\"o\">());</span> <span class=\"c1\">//=&gt; field</span>\n</code></pre></div></div>\n\n<p>これでいいのでは？</p>\n\n<div class=\"code-frame\" data-lang=\"java\"><div class=\"highlight\"><pre><code><span class=\"kd\">public</span> <span class=\"kd\">enum</span> <span class=\"nc\">Singleton</span> <span class=\"o\">{</span>\n\n    <span class=\"no\">INSTANCE</span><span class=\"o\">;</span>\n\n    <span class=\"kd\">private</span> <span class=\"nc\">String</span> <span class=\"n\">field</span> <span class=\"o\">=</span> <span class=\"s\">\"field\"</span><span class=\"o\">;</span>\n\n    <span class=\"kd\">public</span> <span class=\"nc\">String</span> <span class=\"nf\">getField</span><span class=\"o\">()</span> <span class=\"o\">{</span>\n        <span class=\"k\">return</span> <span class=\"n\">field</span><span class=\"o\">;</span>\n    <span class=\"o\">}</span>\n\n    <span class=\"kd\">public</span> <span class=\"kt\">void</span> <span class=\"nf\">setField</span><span class=\"o\">(</span><span class=\"nc\">String</span> <span class=\"n\">field</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n        <span class=\"k\">this</span><span class=\"o\">.</span><span class=\"na\">field</span> <span class=\"o\">=</span> <span class=\"n\">field</span><span class=\"o\">;</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n</code></pre></div></div>\n","updated_at":"2017-06-05T09:25:56+09:00","user":{"description":"","facebook_id":"","followees_count":0,"followers_count":22,"github_login_name":"saka1029","id":"saka1029","items_count":23,"linkedin_id":"","location":"","name":"saka1029","organization":"","permanent_id":78427,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/78427/profile-images/1473701156","team_only":false,"twitter_screen_name":null,"website_url":""}}]