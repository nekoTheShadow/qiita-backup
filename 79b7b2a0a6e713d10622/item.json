{"rendered_body":"<p data-sourcepos=\"1:1-1:199\">JavaにはXMLを扱うライブラリがいくつか用意されています。そのうちDOMと呼ばれるライブラリを使ってXMLを読みこむサンプルをここでは紹介します。</p>\n<div data-sourcepos=\"3:1-5:3\" class=\"note info\">\n<span class=\"fa fa-fw fa-check-circle\"></span><div>\n<p data-sourcepos=\"4:1-4:183\">自分用のメモの側面があります。XMLを読み込むスクリプトを書くことがたまにあり、そのたびにググらないようにするための記事です。</p>\n</div>\n</div>\n<p data-sourcepos=\"7:1-7:74\">ECサイトの注文情報を記載したorder.xmlがあるとします。</p>\n<div class=\"code-frame\" data-lang=\"xml\" data-sourcepos=\"9:1-28:3\">\n<div class=\"code-lang\"><span class=\"bold\">order.xml</span></div>\n<div class=\"highlight\"><pre><code><span class=\"cp\">&lt;?xml version=\"1.0\"?&gt;</span>\n<span class=\"nt\">&lt;Orders&gt;</span>\n\t<span class=\"nt\">&lt;Order</span> <span class=\"na\">Customer=</span><span class=\"s\">\"高津一郎\"</span> <span class=\"na\">Address=</span><span class=\"s\">\"神奈川県川崎市高津区\"</span> <span class=\"na\">Phone=</span><span class=\"s\">\"0000-1111-2222\"</span><span class=\"nt\">&gt;</span>\n\t\t<span class=\"nt\">&lt;Product&gt;</span>ボールペン<span class=\"nt\">&lt;/Product&gt;</span>\n\t\t<span class=\"nt\">&lt;Price&gt;</span>100<span class=\"nt\">&lt;/Price&gt;</span>\n\t\t<span class=\"nt\">&lt;Quantity&gt;</span>1<span class=\"nt\">&lt;/Quantity&gt;</span>\n\t<span class=\"nt\">&lt;/Order&gt;</span>\n\t<span class=\"nt\">&lt;Order</span> <span class=\"na\">Customer=</span><span class=\"s\">\"中原二郎\"</span> <span class=\"na\">Address=</span><span class=\"s\">\"神奈川県中原市中原区\"</span> <span class=\"na\">Phone=</span><span class=\"s\">\"1111-2222-3333\"</span><span class=\"nt\">&gt;</span>\n\t\t<span class=\"nt\">&lt;Product&gt;</span>消しゴム<span class=\"nt\">&lt;/Product&gt;</span>\n\t\t<span class=\"nt\">&lt;Price&gt;</span>150<span class=\"nt\">&lt;/Price&gt;</span>\n\t\t<span class=\"nt\">&lt;Quantity&gt;</span>2<span class=\"nt\">&lt;/Quantity&gt;</span>\n\t<span class=\"nt\">&lt;/Order&gt;</span>\n\t<span class=\"nt\">&lt;Order</span> <span class=\"na\">Customer=</span><span class=\"s\">\"多摩三郎\"</span> <span class=\"na\">Address=</span><span class=\"s\">\"神奈川県川崎市多摩区\"</span> <span class=\"na\">Phone=</span><span class=\"s\">\"2222-3333-4444\"</span><span class=\"nt\">&gt;</span>\n\t\t<span class=\"nt\">&lt;Product&gt;</span>はさみ<span class=\"nt\">&lt;/Product&gt;</span>\n\t\t<span class=\"nt\">&lt;Price&gt;</span>200<span class=\"nt\">&lt;/Price&gt;</span>\n\t\t<span class=\"nt\">&lt;Quantity&gt;</span>4<span class=\"nt\">&lt;/Quantity&gt;</span>\n\t<span class=\"nt\">&lt;/Order&gt;</span>\n<span class=\"nt\">&lt;/Orders&gt;</span>\n</code></pre></div>\n</div>\n<p data-sourcepos=\"30:1-30:69\">このorder.xmlに対して、以下の要件があるとします。</p>\n<ol data-sourcepos=\"32:1-34:0\">\n<li data-sourcepos=\"32:1-32:53\">Order要素の属性すべてをPretty Printする</li>\n<li data-sourcepos=\"33:1-34:0\">Order要素の子要素すべてをPretty Printする</li>\n</ol>\n<p data-sourcepos=\"35:1-35:57\">これを実現するコードは以下の通りです。</p>\n<div class=\"code-frame\" data-lang=\"java\" data-sourcepos=\"37:1-83:3\"><div class=\"highlight\"><pre><code><span class=\"nc\">Path</span> <span class=\"n\">xmlPath</span> <span class=\"o\">=</span> <span class=\"nc\">Paths</span><span class=\"o\">.</span><span class=\"na\">get</span><span class=\"o\">(</span><span class=\"s\">\"order.xml\"</span><span class=\"o\">);</span>\n<span class=\"k\">try</span> <span class=\"o\">(</span><span class=\"nc\">InputStream</span> <span class=\"n\">inputStream</span> <span class=\"o\">=</span> <span class=\"nc\">Files</span><span class=\"o\">.</span><span class=\"na\">newInputStream</span><span class=\"o\">(</span><span class=\"n\">xmlPath</span><span class=\"o\">))</span> <span class=\"o\">{</span>\n\t<span class=\"nc\">Document</span> <span class=\"n\">document</span> <span class=\"o\">=</span> <span class=\"nc\">DocumentBuilderFactory</span><span class=\"o\">.</span><span class=\"na\">newInstance</span><span class=\"o\">().</span><span class=\"na\">newDocumentBuilder</span><span class=\"o\">().</span><span class=\"na\">parse</span><span class=\"o\">(</span><span class=\"n\">inputStream</span><span class=\"o\">);</span>\n\n\t<span class=\"c1\">// ルート要素を取得する。</span>\n\t<span class=\"nc\">Element</span> <span class=\"n\">orders</span> <span class=\"o\">=</span> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"na\">getDocumentElement</span><span class=\"o\">();</span>\n\n\t<span class=\"c1\">// ルート要素の直下にあるノードの一覧を取得する。</span>\n\t<span class=\"nc\">NodeList</span> <span class=\"n\">orderList</span> <span class=\"o\">=</span> <span class=\"n\">orders</span><span class=\"o\">.</span><span class=\"na\">getChildNodes</span><span class=\"o\">();</span>\n\t<span class=\"k\">for</span> <span class=\"o\">(</span><span class=\"kt\">int</span> <span class=\"n\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"o\">;</span> <span class=\"n\">i</span> <span class=\"o\">&lt;</span> <span class=\"n\">orderList</span><span class=\"o\">.</span><span class=\"na\">getLength</span><span class=\"o\">();</span> <span class=\"n\">i</span><span class=\"o\">++)</span> <span class=\"o\">{</span>\n\t\t<span class=\"c1\">// Order要素を取得する。NodeListには要素以外も格納されているので、要素だけを取得するようにする。</span>\n\t\t<span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"n\">orderList</span><span class=\"o\">.</span><span class=\"na\">item</span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"o\">).</span><span class=\"na\">getNodeType</span><span class=\"o\">()</span> <span class=\"o\">!=</span> <span class=\"nc\">Node</span><span class=\"o\">.</span><span class=\"na\">ELEMENT_NODE</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n\t\t\t<span class=\"k\">continue</span><span class=\"o\">;</span>\n\t\t<span class=\"o\">}</span>\n\t\t<span class=\"nc\">Element</span> <span class=\"n\">order</span> <span class=\"o\">=</span> <span class=\"o\">(</span><span class=\"nc\">Element</span><span class=\"o\">)</span> <span class=\"n\">orderList</span><span class=\"o\">.</span><span class=\"na\">item</span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"o\">);</span>\n\n\t\t<span class=\"c1\">// Order要素の属性をすべて取得し、Pretty Printする</span>\n\t\t<span class=\"nc\">NamedNodeMap</span> <span class=\"n\">attributes</span> <span class=\"o\">=</span> <span class=\"n\">order</span><span class=\"o\">.</span><span class=\"na\">getAttributes</span><span class=\"o\">();</span>\n\t\t<span class=\"k\">for</span> <span class=\"o\">(</span><span class=\"kt\">int</span> <span class=\"n\">j</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"o\">;</span> <span class=\"n\">j</span> <span class=\"o\">&lt;</span> <span class=\"n\">attributes</span><span class=\"o\">.</span><span class=\"na\">getLength</span><span class=\"o\">();</span> <span class=\"n\">j</span><span class=\"o\">++)</span> <span class=\"o\">{</span>\n\t\t\t<span class=\"nc\">Attr</span> <span class=\"n\">attribute</span> <span class=\"o\">=</span> <span class=\"o\">(</span><span class=\"nc\">Attr</span><span class=\"o\">)</span> <span class=\"n\">attributes</span><span class=\"o\">.</span><span class=\"na\">item</span><span class=\"o\">(</span><span class=\"n\">j</span><span class=\"o\">);</span>\n\t\t\t<span class=\"nc\">String</span> <span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"n\">attribute</span><span class=\"o\">.</span><span class=\"na\">getName</span><span class=\"o\">();</span>\n\t\t\t<span class=\"nc\">String</span> <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"n\">attribute</span><span class=\"o\">.</span><span class=\"na\">getValue</span><span class=\"o\">();</span>\n\t\t\t<span class=\"nc\">System</span><span class=\"o\">.</span><span class=\"na\">out</span><span class=\"o\">.</span><span class=\"na\">printf</span><span class=\"o\">(</span><span class=\"s\">\"%s=%s%n\"</span><span class=\"o\">,</span> <span class=\"n\">name</span><span class=\"o\">,</span> <span class=\"n\">value</span><span class=\"o\">);</span>\n\t\t<span class=\"o\">}</span>\n\n\t\t<span class=\"c1\">// Order要素の直下にあるノードの一覧を取得する。</span>\n\t\t<span class=\"nc\">NodeList</span> <span class=\"n\">orderDetailList</span> <span class=\"o\">=</span> <span class=\"n\">order</span><span class=\"o\">.</span><span class=\"na\">getChildNodes</span><span class=\"o\">();</span>\n\t\t<span class=\"k\">for</span> <span class=\"o\">(</span><span class=\"kt\">int</span> <span class=\"n\">j</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"o\">;</span> <span class=\"n\">j</span> <span class=\"o\">&lt;</span> <span class=\"n\">orderDetailList</span><span class=\"o\">.</span><span class=\"na\">getLength</span><span class=\"o\">();</span> <span class=\"n\">j</span><span class=\"o\">++)</span> <span class=\"o\">{</span>\n\t\t\t<span class=\"c1\">// Order要素の直下にある要素を取得する。NodeListには要素以外も格納されているので、要素だけを取得するようにする。</span>\n\t\t\t<span class=\"k\">if</span> <span class=\"o\">(</span><span class=\"n\">orderDetailList</span><span class=\"o\">.</span><span class=\"na\">item</span><span class=\"o\">(</span><span class=\"n\">j</span><span class=\"o\">).</span><span class=\"na\">getNodeType</span><span class=\"o\">()</span> <span class=\"o\">!=</span> <span class=\"nc\">Node</span><span class=\"o\">.</span><span class=\"na\">ELEMENT_NODE</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n\t\t\t\t<span class=\"k\">continue</span><span class=\"o\">;</span>\n\t\t\t<span class=\"o\">}</span>\n\t\t\t<span class=\"nc\">Element</span> <span class=\"n\">orderDetail</span> <span class=\"o\">=</span> <span class=\"o\">(</span><span class=\"nc\">Element</span><span class=\"o\">)</span> <span class=\"n\">orderDetailList</span><span class=\"o\">.</span><span class=\"na\">item</span><span class=\"o\">(</span><span class=\"n\">j</span><span class=\"o\">);</span>\n\n\t\t\t<span class=\"c1\">// Order要素の直下にある要素をPretty Printする。</span>\n\t\t\t<span class=\"nc\">String</span> <span class=\"n\">tagName</span> <span class=\"o\">=</span> <span class=\"n\">orderDetail</span><span class=\"o\">.</span><span class=\"na\">getTagName</span><span class=\"o\">();</span>\n\t\t\t<span class=\"nc\">String</span> <span class=\"n\">textContent</span> <span class=\"o\">=</span> <span class=\"n\">orderDetail</span><span class=\"o\">.</span><span class=\"na\">getTextContent</span><span class=\"o\">();</span>\n\t\t\t<span class=\"nc\">System</span><span class=\"o\">.</span><span class=\"na\">out</span><span class=\"o\">.</span><span class=\"na\">printf</span><span class=\"o\">(</span><span class=\"s\">\"%s=%s%n\"</span><span class=\"o\">,</span> <span class=\"n\">tagName</span><span class=\"o\">,</span> <span class=\"n\">textContent</span><span class=\"o\">);</span>\n\t\t<span class=\"o\">}</span>\n\n\t\t<span class=\"nc\">System</span><span class=\"o\">.</span><span class=\"na\">out</span><span class=\"o\">.</span><span class=\"na\">println</span><span class=\"o\">(</span><span class=\"s\">\"------------------------------\"</span><span class=\"o\">);</span>\n\t<span class=\"o\">}</span>\n<span class=\"o\">}</span> <span class=\"k\">catch</span> <span class=\"o\">(</span><span class=\"nc\">IOException</span> <span class=\"o\">|</span> <span class=\"nc\">SAXException</span> <span class=\"o\">|</span> <span class=\"nc\">ParserConfigurationException</span> <span class=\"n\">e</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n\t<span class=\"n\">e</span><span class=\"o\">.</span><span class=\"na\">printStackTrace</span><span class=\"o\">();</span>\n<span class=\"o\">}</span>\n</code></pre></div></div>\n<p data-sourcepos=\"85:1-85:96\">このプログラムを実行すると、以下のような結果が得られるはずです。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"87:1-109:3\"><div class=\"highlight\"><pre><code>Address=神奈川県川崎市高津区\nCustomer=高津一郎\nPhone=0000-1111-2222\nProduct=ボールペン\nPrice=100\nQuantity=1\n------------------------------\nAddress=神奈川県中原市中原区\nCustomer=中原二郎\nPhone=1111-2222-3333\nProduct=消しゴム\nPrice=150\nQuantity=2\n------------------------------\nAddress=神奈川県川崎市多摩区\nCustomer=多摩三郎\nPhone=2222-3333-4444\nProduct=はさみ\nPrice=200\nQuantity=4\n------------------------------\n</code></pre></div></div>\n<p data-sourcepos=\"111:1-111:16\"><strong>環境情報</strong></p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"113:1-121:3\"><div class=\"highlight\"><pre><code>D:\\&gt;javac -version\njavac 17.0.3\n\nD:\\&gt;java -version\nopenjdk version \"17.0.3\" 2022-04-19\nOpenJDK Runtime Environment Temurin-17.0.3+7 (build 17.0.3+7)\nOpenJDK 64-Bit Server VM Temurin-17.0.3+7 (build 17.0.3+7, mixed mode, sharing)\n</code></pre></div></div>\n","body":"JavaにはXMLを扱うライブラリがいくつか用意されています。そのうちDOMと呼ばれるライブラリを使ってXMLを読みこむサンプルをここでは紹介します。\n\n:::note info\n自分用のメモの側面があります。XMLを読み込むスクリプトを書くことがたまにあり、そのたびにググらないようにするための記事です。\n:::\n\nECサイトの注文情報を記載したorder.xmlがあるとします。\n\n```xml:order.xml\n<?xml version=\"1.0\"?>\n<Orders>\n\t<Order Customer=\"高津一郎\" Address=\"神奈川県川崎市高津区\" Phone=\"0000-1111-2222\">\n\t\t<Product>ボールペン</Product>\n\t\t<Price>100</Price>\n\t\t<Quantity>1</Quantity>\n\t</Order>\n\t<Order Customer=\"中原二郎\" Address=\"神奈川県中原市中原区\" Phone=\"1111-2222-3333\">\n\t\t<Product>消しゴム</Product>\n\t\t<Price>150</Price>\n\t\t<Quantity>2</Quantity>\n\t</Order>\n\t<Order Customer=\"多摩三郎\" Address=\"神奈川県川崎市多摩区\" Phone=\"2222-3333-4444\">\n\t\t<Product>はさみ</Product>\n\t\t<Price>200</Price>\n\t\t<Quantity>4</Quantity>\n\t</Order>\n</Orders>\n```\n\nこのorder.xmlに対して、以下の要件があるとします。\n\n1. Order要素の属性すべてをPretty Printする\n2. Order要素の子要素すべてをPretty Printする\n\nこれを実現するコードは以下の通りです。\n\n```java\nPath xmlPath = Paths.get(\"order.xml\");\ntry (InputStream inputStream = Files.newInputStream(xmlPath)) {\n\tDocument document = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(inputStream);\n\n\t// ルート要素を取得する。\n\tElement orders = document.getDocumentElement();\n\n\t// ルート要素の直下にあるノードの一覧を取得する。\n\tNodeList orderList = orders.getChildNodes();\n\tfor (int i = 0; i < orderList.getLength(); i++) {\n\t\t// Order要素を取得する。NodeListには要素以外も格納されているので、要素だけを取得するようにする。\n\t\tif (orderList.item(i).getNodeType() != Node.ELEMENT_NODE) {\n\t\t\tcontinue;\n\t\t}\n\t\tElement order = (Element) orderList.item(i);\n\n\t\t// Order要素の属性をすべて取得し、Pretty Printする\n\t\tNamedNodeMap attributes = order.getAttributes();\n\t\tfor (int j = 0; j < attributes.getLength(); j++) {\n\t\t\tAttr attribute = (Attr) attributes.item(j);\n\t\t\tString name = attribute.getName();\n\t\t\tString value = attribute.getValue();\n\t\t\tSystem.out.printf(\"%s=%s%n\", name, value);\n\t\t}\n\n\t\t// Order要素の直下にあるノードの一覧を取得する。\n\t\tNodeList orderDetailList = order.getChildNodes();\n\t\tfor (int j = 0; j < orderDetailList.getLength(); j++) {\n\t\t\t// Order要素の直下にある要素を取得する。NodeListには要素以外も格納されているので、要素だけを取得するようにする。\n\t\t\tif (orderDetailList.item(j).getNodeType() != Node.ELEMENT_NODE) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tElement orderDetail = (Element) orderDetailList.item(j);\n\n\t\t\t// Order要素の直下にある要素をPretty Printする。\n\t\t\tString tagName = orderDetail.getTagName();\n\t\t\tString textContent = orderDetail.getTextContent();\n\t\t\tSystem.out.printf(\"%s=%s%n\", tagName, textContent);\n\t\t}\n\n\t\tSystem.out.println(\"------------------------------\");\n\t}\n} catch (IOException | SAXException | ParserConfigurationException e) {\n\te.printStackTrace();\n}\n```\n\nこのプログラムを実行すると、以下のような結果が得られるはずです。\n\n```\nAddress=神奈川県川崎市高津区\nCustomer=高津一郎\nPhone=0000-1111-2222\nProduct=ボールペン\nPrice=100\nQuantity=1\n------------------------------\nAddress=神奈川県中原市中原区\nCustomer=中原二郎\nPhone=1111-2222-3333\nProduct=消しゴム\nPrice=150\nQuantity=2\n------------------------------\nAddress=神奈川県川崎市多摩区\nCustomer=多摩三郎\nPhone=2222-3333-4444\nProduct=はさみ\nPrice=200\nQuantity=4\n------------------------------\n```\n\n**環境情報**\n\n```\nD:\\>javac -version\njavac 17.0.3\n\nD:\\>java -version\nopenjdk version \"17.0.3\" 2022-04-19\nOpenJDK Runtime Environment Temurin-17.0.3+7 (build 17.0.3+7)\nOpenJDK 64-Bit Server VM Temurin-17.0.3+7 (build 17.0.3+7, mixed mode, sharing)\n```\n","coediting":false,"comments_count":0,"created_at":"2023-09-07T21:51:44+09:00","group":null,"id":"79b7b2a0a6e713d10622","likes_count":0,"private":false,"reactions_count":0,"stocks_count":0,"tags":[{"name":"Java","versions":[]}],"title":"DOMを利用してXMLを読み込むサンプル","updated_at":"2023-09-07T21:51:44+09:00","url":"https://qiita.com/neko_the_shadow/items/79b7b2a0a6e713d10622","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":38,"github_login_name":"nekoTheShadow","id":"neko_the_shadow","items_count":224,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://github.com/nekoTheShadow"},"page_views_count":456,"team_membership":null,"organization_url_name":null,"slide":false}