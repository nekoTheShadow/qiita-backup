{"rendered_body":"<p>Db2関係のプロジェクトのメンバーでも意外に知らない人がいるので、簡単にまとめておきます(´・ω・｀) もっともポピュラーな起動方法(だとわたしが勝手に思っている)のが<code>db2start</code>。<code>db2start</code>を発行したユーザがインスタンスユーザとして管理しているインスタンスを起動します。</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>su - db2inst1\ndb2start\n<span class=\"c\"># あるいは</span>\nsu - db2inst1 <span class=\"nt\">-c</span> <span class=\"s2\">\"db2start\"</span>\n</pre></div></div>\n\n<p>select文やinsert文と同じ階層(?)で、インスタンスを起動したい場合は<code>start database manager</code>を利用します。<code>db2 -f path</code>とするとpathに指定したファイルを読み込んで、SQLを実行することはDb2ユーザの中では比較的よく知られていますが、その入力として<code>start database manager</code>は使いやすかったです(実体験)。</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><span class=\"c\"># すべて同じ</span>\ndb2 <span class=\"s2\">\"start database manager\"</span>\ndb2 <span class=\"s2\">\"start db manager\"</span>\ndb2 <span class=\"s2\">\"start dbm\"</span>\n</pre></div></div>\n\n<p>最後に<code>db2gcf</code>。<code>db2gcf</code>はインスタンスの起動・終了・監視をつかさどるコマンドで、起動の場合は<code>-u</code>オプションを指定します。<code>db2start</code>にしろ<code>start database manager</code>とは違い<code>su</code>の必要がないので、単一のシェルスクリプトから複数のインスタンスの起動を行う場合などに有用でした(実体験)。ただし実行には<code>root</code>権限が必要になります。</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><span class=\"c\"># ひとつのシェルスクリプトから複数インスタンスを起動する</span>\ndb2gcf <span class=\"nt\">-u</span> <span class=\"nt\">-i</span> db2inst1\ndb2gcf <span class=\"nt\">-u</span> <span class=\"nt\">-i</span> db2inst2\ndb2gcf <span class=\"nt\">-u</span> <span class=\"nt\">-i</span> db2inst3\n</pre></div></div>\n\n<hr>\n\n<p>\"起動\"があれば、当然\"停止\"コマンドも存在します。<code>db2start</code>に対応するものが<code>db2stop</code>、<code>start database manager</code>に対応するものが<code>stop database manager</code>。<code>db2gcf</code>の場合は<code>-d</code>オプションを指定すると\"停止\"モードになります。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre># すべて停止コマンド\nsu - db2inst1 -c \"db2stop\"\ndb2 \"stop database manager\"\ndb2gcf -d -i db2inst1\n</pre></div></div>\n\n<p>ところで上述のコマンドをたたいたとき、次のようなエラーメッセージが出力され、インスタンスが停止しないということがあります:「SQL1025N  The database manager was not stopped because databases are still active.」。たいていは何らかのアプリケーションが対象のインスタンスに接続しているために起きるのですが、これを無視して強制的にインスタンス停止を行うにはどうすればよいでしょうか。</p>\n\n<p>まず<code>db2stop</code>の場合は<code>db2stop force</code>、<code>stop database manager</code>の場合は<code>stop database manager force</code>とそれぞれ<code>force</code>を付与します。次に<code>db2gcf</code>ですが、<code>-k</code>オプションを付与すると<code>db2stop force</code>に近い挙動を示すようです(´・ω・｀)</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>すべて強制停止コマンド\nsu - db2inst1 <span class=\"nt\">-c</span> <span class=\"s2\">\"db2stop force\"</span>\ndb2 <span class=\"s2\">\"stop database manager force\"</span>\ndb2gcf <span class=\"nt\">-k</span> <span class=\"nt\">-d</span> <span class=\"nt\">-i</span> db2ins1\n</pre></div></div>\n\n<p>参考:</p>\n\n<ul>\n<li><a href=\"https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001939.html\" rel=\"nofollow noopener\" target=\"_blank\">「db2start - Start DB2 コマンド」</a></li>\n<li><a href=\"https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001940.html\" rel=\"nofollow noopener\" target=\"_blank\">「db2stop - DB2 の停止コマンド」</a></li>\n<li><a href=\"https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001982.html\" rel=\"nofollow noopener\" target=\"_blank\">「START DATABASE MANAGER コマンド」</a></li>\n<li><a href=\"https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001983.html\" rel=\"nofollow noopener\" target=\"_blank\">「STOP DATABASE MANAGER コマンド」</a></li>\n<li><a href=\"https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0010986.html\" rel=\"nofollow noopener\" target=\"_blank\">「db2gcf - DB2 インスタンスの制御 コマンド」</a></li>\n</ul>\n","body":"Db2関係のプロジェクトのメンバーでも意外に知らない人がいるので、簡単にまとめておきます(´・ω・｀) もっともポピュラーな起動方法(だとわたしが勝手に思っている)のが`db2start`。`db2start`を発行したユーザがインスタンスユーザとして管理しているインスタンスを起動します。\n\n```bash\nsu - db2inst1\ndb2start\n# あるいは\nsu - db2inst1 -c \"db2start\"\n```\n\nselect文やinsert文と同じ階層(?)で、インスタンスを起動したい場合は`start database manager`を利用します。`db2 -f path`とするとpathに指定したファイルを読み込んで、SQLを実行することはDb2ユーザの中では比較的よく知られていますが、その入力として`start database manager`は使いやすかったです(実体験)。\n\n```bash\n# すべて同じ\ndb2 \"start database manager\"\ndb2 \"start db manager\"\ndb2 \"start dbm\"\n```\n\n最後に`db2gcf`。`db2gcf`はインスタンスの起動・終了・監視をつかさどるコマンドで、起動の場合は`-u`オプションを指定します。`db2start`にしろ`start database manager`とは違い`su`の必要がないので、単一のシェルスクリプトから複数のインスタンスの起動を行う場合などに有用でした(実体験)。ただし実行には`root`権限が必要になります。\n\n```bash\n# ひとつのシェルスクリプトから複数インスタンスを起動する\ndb2gcf -u -i db2inst1\ndb2gcf -u -i db2inst2\ndb2gcf -u -i db2inst3\n```\n\n***\n\n\"起動\"があれば、当然\"停止\"コマンドも存在します。`db2start`に対応するものが`db2stop`、`start database manager`に対応するものが`stop database manager`。`db2gcf`の場合は`-d`オプションを指定すると\"停止\"モードになります。\n\n```\n# すべて停止コマンド\nsu - db2inst1 -c \"db2stop\"\ndb2 \"stop database manager\"\ndb2gcf -d -i db2inst1\n```\n\nところで上述のコマンドをたたいたとき、次のようなエラーメッセージが出力され、インスタンスが停止しないということがあります:「SQL1025N  The database manager was not stopped because databases are still active.」。たいていは何らかのアプリケーションが対象のインスタンスに接続しているために起きるのですが、これを無視して強制的にインスタンス停止を行うにはどうすればよいでしょうか。\n\nまず`db2stop`の場合は`db2stop force`、`stop database manager`の場合は`stop database manager force`とそれぞれ`force`を付与します。次に`db2gcf`ですが、`-k`オプションを付与すると`db2stop force`に近い挙動を示すようです(´・ω・｀)\n\n```bash\nすべて強制停止コマンド\nsu - db2inst1 -c \"db2stop force\"\ndb2 \"stop database manager force\"\ndb2gcf -k -d -i db2ins1\n```\n\n参考:\n\n- [「db2start - Start DB2 コマンド」](https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001939.html)\n- [「db2stop - DB2 の停止コマンド」](https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001940.html)\n- [「START DATABASE MANAGER コマンド」](https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001982.html)\n- [「STOP DATABASE MANAGER コマンド」](https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0001983.html)\n- [「db2gcf - DB2 インスタンスの制御 コマンド」](https://www.ibm.com/support/knowledgecenter/ja/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0010986.html)\n","coediting":false,"comments_count":0,"created_at":"2018-02-01T00:57:04+09:00","group":null,"id":"469cb909a9d0252c7cc1","likes_count":4,"private":false,"reactions_count":0,"tags":[{"name":"db2","versions":[]}],"title":"Db2インスタンスの起動と停止に関するメモ","updated_at":"2018-02-01T13:03:36+09:00","url":"https://qiita.com/neko_the_shadow/items/469cb909a9d0252c7cc1","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":35,"github_login_name":null,"id":"neko_the_shadow","items_count":179,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null}