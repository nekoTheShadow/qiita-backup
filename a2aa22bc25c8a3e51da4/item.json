{"rendered_body":"<p>どうでもいいですが、この4月から社会人になりました。毎日5時半に起床、夢の国に向かう電車に揺られて職場まで通っております。研修にもかかわらず、残業がわっしょいなことになっており、日本のIT(SIer)の暗部を真にあたりにしています……。ねむいつらい(´・ω・`)</p>\n\n<p>それはさておき――<a href=\"https://codeiq.jp/q/2561\" rel=\"nofollow noopener\" target=\"_blank\">CodeIQ「『ディビジョン・ナイン』問題」</a>の掲載期間が終わったということで、わたしの提出コードを公開したいと思います。</p>\n\n<p>詳細な問題や解法についてはCodeIQMagazineあたりに<a href=\"https://twitter.com/riverplus\" rel=\"nofollow noopener\" target=\"_blank\">@riverplus</a>さんの記事が掲載されると思うので、その際はリンクをここに張り付けておきます(覚えていれば)。またほかの方のコードに関してもTogetterにまとめられる(はず)なので、ご参照のほどをお願いします。そちらも余力があればリンクを追記したいと思います。</p>\n\n<h2>\n<span id=\"提出コード\" class=\"fragment\"></span><a href=\"#%E6%8F%90%E5%87%BA%E3%82%B3%E3%83%BC%E3%83%89\"><i class=\"fa fa-link\"></i></a>提出コード</h2>\n\n<p>使用言語はRuby。おそらくですが一発合格だったと思います。</p>\n\n<div class=\"code-frame\" data-lang=\"rb\"><div class=\"highlight\"><pre><code><span class=\"c1\"># 1から4までの数字をn個並べたもののうち、合計がsとなるものの総数</span>\n<span class=\"c1\"># g(3, 5) =&gt; 6 [113, 131, 311, 122, 212, 221]</span>\n<span class=\"vi\">@memo</span> <span class=\"o\">=</span> <span class=\"no\">Hash</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">{</span><span class=\"o\">|</span><span class=\"n\">ht</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"o\">|</span> <span class=\"n\">ht</span><span class=\"p\">[</span><span class=\"n\">key</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"no\">Hash</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">}</span>\n<span class=\"k\">def</span> <span class=\"nf\">g</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">,</span> <span class=\"n\">s</span><span class=\"p\">)</span>\n    <span class=\"vi\">@memo</span><span class=\"p\">[</span><span class=\"n\">n</span><span class=\"p\">][</span><span class=\"n\">s</span><span class=\"p\">]</span> <span class=\"o\">||=</span> <span class=\"k\">if</span> <span class=\"n\">n</span> <span class=\"o\">==</span> <span class=\"mi\">1</span>\n        <span class=\"n\">s</span><span class=\"p\">.</span><span class=\"nf\">between?</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">)</span> <span class=\"p\">?</span> <span class=\"mi\">1</span> <span class=\"p\">:</span> <span class=\"mi\">0</span>\n    <span class=\"k\">else</span>\n        <span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">..</span><span class=\"mi\">4</span><span class=\"p\">).</span><span class=\"nf\">reduce</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">){</span><span class=\"o\">|</span><span class=\"n\">sum</span><span class=\"p\">,</span> <span class=\"n\">i</span><span class=\"o\">|</span> <span class=\"n\">sum</span> <span class=\"o\">+</span> <span class=\"n\">g</span><span class=\"p\">(</span><span class=\"n\">n</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">s</span> <span class=\"o\">-</span> <span class=\"n\">i</span><span class=\"p\">)}</span>\n    <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"c1\"># 問題文中のF(n)。1から4*nに含まれる9の倍数をsとしてg(s, n)を実行、その和を返す</span>\n<span class=\"c1\"># f(3) =&gt; 10, f(1) =&gt; 0</span>\n<span class=\"k\">def</span> <span class=\"nf\">f</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"o\">..</span><span class=\"p\">(</span><span class=\"mi\">4</span> <span class=\"o\">*</span> <span class=\"n\">n</span><span class=\"p\">)).</span><span class=\"nf\">step</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">).</span><span class=\"nf\">reduce</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">){</span><span class=\"o\">|</span><span class=\"n\">sum</span><span class=\"p\">,</span> <span class=\"n\">s</span><span class=\"o\">|</span> <span class=\"n\">sum</span> <span class=\"o\">+</span> <span class=\"n\">g</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">,</span> <span class=\"n\">s</span><span class=\"p\">)}</span>\n<span class=\"k\">end</span>\n\n<span class=\"c1\"># == main ==</span>\n<span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"nb\">gets</span><span class=\"p\">.</span><span class=\"nf\">to_i</span>\n<span class=\"nb\">p</span> <span class=\"n\">f</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n</code></pre></div></div>\n\n<h2>\n<span id=\"考察\" class=\"fragment\"></span><a href=\"#%E8%80%83%E5%AF%9F\"><i class=\"fa fa-link\"></i></a>考察</h2>\n\n<p>ある自然数について、各位の桁の和が9の倍数となるとき、その自然数も9の倍数である――という性質はよく知られています。そこで1から4までの数字を$n$個並べたもののうち、合計が$s$となるものの総数を$G(n,s)$とすると、この$G$は再帰的に表現できるはずです。</p>\n\n<div class=\"code-frame\" data-lang=\"math\"><div class=\"highlight\"><pre><code>G(n,s)=G(n-1,s-1)+G(n-1,s-2)+G(n-1,s-3)+G(n-1,n-3)\n</code></pre></div></div>\n\n<p>あとはこれをコードに落とし込んでやるだけですが、ただし単純な再帰だと計算量やオーバヘッドが大きくなりすぎて、制限時間を軽々と超えてしまいます。つまり高速化が必要であり、今回は<code>Hash</code>によるメモ化再帰を実践しました。試していないのでなんともいいがたいところはあるのですが、動的計画法などでもまったく構わないと思います。</p>\n\n<p>なお求めるのは9の倍数のとき、すなわち$s$が9の倍数になるときだけ。これについては1から$4n$(=$444...44$)に含まれる9の倍数をsとして順次$G(n,s)$を実行、その和が求める$F(n)$となるわけです。</p>\n\n<hr>\n\n<p>眠すぎて文章が支離滅裂かもしれません。お許しを(´・ω・`)</p>\n","body":"どうでもいいですが、この4月から社会人になりました。毎日5時半に起床、夢の国に向かう電車に揺られて職場まで通っております。研修にもかかわらず、残業がわっしょいなことになっており、日本のIT(SIer)の暗部を真にあたりにしています……。ねむいつらい(´・ω・`)\n\nそれはさておき――[CodeIQ「『ディビジョン・ナイン』問題」](https://codeiq.jp/q/2561)の掲載期間が終わったということで、わたしの提出コードを公開したいと思います。\n\n詳細な問題や解法についてはCodeIQMagazineあたりに[@riverplus](https://twitter.com/riverplus)さんの記事が掲載されると思うので、その際はリンクをここに張り付けておきます(覚えていれば)。またほかの方のコードに関してもTogetterにまとめられる(はず)なので、ご参照のほどをお願いします。そちらも余力があればリンクを追記したいと思います。\n\n## 提出コード\n\n使用言語はRuby。おそらくですが一発合格だったと思います。\n\n```rb\n# 1から4までの数字をn個並べたもののうち、合計がsとなるものの総数\n# g(3, 5) => 6 [113, 131, 311, 122, 212, 221]\n@memo = Hash.new{|ht, key| ht[key] = Hash.new}\ndef g(n, s)\n    @memo[n][s] ||= if n == 1\n        s.between?(1, 4) ? 1 : 0\n    else\n        (1..4).reduce(0){|sum, i| sum + g(n - 1, s - i)}\n    end\nend\n\n# 問題文中のF(n)。1から4*nに含まれる9の倍数をsとしてg(s, n)を実行、その和を返す\n# f(3) => 10, f(1) => 0\ndef f(n)\n    (9..(4 * n)).step(9).reduce(0){|sum, s| sum + g(n, s)}\nend\n\n# == main ==\nn = gets.to_i\np f(n)\n```\n\n## 考察\n\nある自然数について、各位の桁の和が9の倍数となるとき、その自然数も9の倍数である――という性質はよく知られています。そこで1から4までの数字を$n$個並べたもののうち、合計が$s$となるものの総数を$G(n,s)$とすると、この$G$は再帰的に表現できるはずです。\n\n```math\nG(n,s)=G(n-1,s-1)+G(n-1,s-2)+G(n-1,s-3)+G(n-1,n-3)\n```\n\nあとはこれをコードに落とし込んでやるだけですが、ただし単純な再帰だと計算量やオーバヘッドが大きくなりすぎて、制限時間を軽々と超えてしまいます。つまり高速化が必要であり、今回は`Hash`によるメモ化再帰を実践しました。試していないのでなんともいいがたいところはあるのですが、動的計画法などでもまったく構わないと思います。\n\nなお求めるのは9の倍数のとき、すなわち$s$が9の倍数になるときだけ。これについては1から$4n$(=$444...44$)に含まれる9の倍数をsとして順次$G(n,s)$を実行、その和が求める$F(n)$となるわけです。\n\n***\n\n眠すぎて文章が支離滅裂かもしれません。お許しを(´・ω・`)\n","coediting":false,"comments_count":0,"created_at":"2016-04-07T20:47:29+09:00","group":null,"id":"a2aa22bc25c8a3e51da4","likes_count":0,"private":false,"reactions_count":0,"stocks_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"codeiq","versions":[]}],"title":"CodeIQ「『ディビジョン・ナイン』問題」に参加しました。","updated_at":"2016-04-07T20:47:29+09:00","url":"https://qiita.com/neko_the_shadow/items/a2aa22bc25c8a3e51da4","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":36,"github_login_name":null,"id":"neko_the_shadow","items_count":214,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://github.com/nekoTheShadow"},"page_views_count":772,"team_membership":null,"organization_url_name":null}