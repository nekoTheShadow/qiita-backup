<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>ずんだのハロウィン問題 bash編 - Qiita Backup</title><meta name=description content="もとねた: 「ずんだのハロウィン問題 Ruby編」 1行野郎は男の浪漫&ndash;ということで、保守性や可読性を無視して、上記記事の条件を満たす"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"Qiita Backup","url":"https:\/\/nekotheshadow.github.io\/qiita-backup"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/nekotheshadow.github.io\/qiita-backup"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/nekotheshadow.github.io\/qiita-backup","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/nekotheshadow.github.io\/qiita-backup\/blog\/784bb2d24f3fa01d294a\/","name":"ずんだのハロウィン問題 bash編"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":""},"headline":"ずんだのハロウィン問題 bash編","description":"もとねた: 「ずんだのハロウィン問題 Ruby編」 1行野郎は男の浪漫\u0026ndash;ということで、保守性や可読性を無視して、上記記事の条件を満たす","inLanguage":"en","wordCount":855,"datePublished":"2018-11-01T00:01:21","dateModified":"2018-11-01T00:01:21","image":"https:\/\/nekotheshadow.github.io\/qiita-backup","keywords":["Bash"],"mainEntityOfPage":"https:\/\/nekotheshadow.github.io\/qiita-backup\/blog\/784bb2d24f3fa01d294a\/","publisher":{"@type":"Organization","name":"https:\/\/nekotheshadow.github.io\/qiita-backup","logo":{"@type":"ImageObject","url":"https:\/\/nekotheshadow.github.io\/qiita-backup","height":60,"width":60}}}</script><meta property="og:title" content="ずんだのハロウィン問題 bash編"><meta property="og:description" content="もとねた: 「ずんだのハロウィン問題 Ruby編」 1行野郎は男の浪漫&ndash;ということで、保守性や可読性を無視して、上記記事の条件を満たす"><meta property="og:url" content="https://nekotheshadow.github.io/qiita-backup/blog/784bb2d24f3fa01d294a/"><meta property="og:type" content="website"><meta property="og:site_name" content="Qiita Backup"><meta name=twitter:title content="ずんだのハロウィン問題 bash編"><meta name=twitter:description content="もとねた: 「ずんだのハロウィン問題 Ruby編」 1行野郎は男の浪漫&ndash;ということで、保守性や可読性を無視して、上記記事の条件を満たす"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><link rel=alternate href=https://nekotheshadow.github.io/qiita-backup/index.xml type=application/rss+xml title="Qiita Backup"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://nekotheshadow.github.io/qiita-backup/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://nekotheshadow.github.io/qiita-backup/css/syntax.css><link rel=stylesheet href=https://nekotheshadow.github.io/qiita-backup/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://nekotheshadow.github.io/qiita-backup>Qiita Backup</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"></ul></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=blog-heading><h1>ずんだのハロウィン問題 bash編</h1><hr class=small></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p>もとねた: <a href=https://qiita.com/tbpgr/items/1f2ed0e14e5d94775963>「ずんだのハロウィン問題 Ruby編」</a></p><p>1行野郎は男の浪漫&ndash;ということで、保守性や可読性を無視して、上記記事の条件を満たすワンライナーを書いてみました。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>echo <span style=color:#e6db74>&#34;trick treat sushi poyayou tamakatsu&#34;</span> | sed <span style=color:#e6db74>&#39;s/\s/\n/g&#39;</span> | shuf -n <span style=color:#ae81ff>1</span>  | awk <span style=color:#e6db74>&#39;{print $0; print match($0, /^tr/) ? &#34;happy halloween&#34; : &#34;sleepy&#34; }&#39;</span>
</code></pre></div><p>さすがに読みずらすぎるので、わかりやすく整形し、適宜コメントを加えたものが以下になります。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>echo <span style=color:#e6db74>&#34;trick treat sushi poyayou tamakatsu&#34;</span> |
<span style=color:#75715e># 空白区切りを改行区切りに変更する。</span>
sed <span style=color:#e6db74>&#39;s/\s/\n/g&#39;</span>                            |
<span style=color:#75715e># 入力をシャッフルし、最初の1行を取り出す。</span>
shuf -n <span style=color:#ae81ff>1</span>                                  |
<span style=color:#75715e># 入力の内容にかかわらず、その内容をそのまま出力した後</span>
<span style=color:#75715e># 入力がtrickまたはtreatの場合は、happy halloweenを出力する。</span>
awk <span style=color:#e6db74>&#39;{
</span><span style=color:#e6db74>  print $0;
</span><span style=color:#e6db74>  print match($0, /^tr/) ? &#34;happy halloween&#34; : &#34;sleepy&#34;                                  
</span><span style=color:#e6db74>}&#39;</span>
</code></pre></div><p>もうちょっと工夫できそうですね(´・ω・｀) とくに最後の<code>awk</code>は無理やり感が出ている。ここもパイプでスマートに書くことができれば、シェル芸人の仲間入りができる&ndash;はず。</p><hr><p>おまけとして、以下のようなスクリプトを作りました。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>seq <span style=color:#ae81ff>1000</span> | <span style=color:#66d9ef>while</span> read x; <span style=color:#66d9ef>do</span>
  echo <span style=color:#e6db74>&#34;trick treat sushi poyayou tamakatsu&#34;</span> | 
    sed <span style=color:#e6db74>&#39;s/\s/\n/g&#39;</span>                          | 
    shuf -n <span style=color:#ae81ff>1</span>                                | 
    awk <span style=color:#e6db74>&#39;{print $0; print match($0, /^tr/) ? &#34;happy halloween&#34; : &#34;sleepy&#34; }&#39;</span>
<span style=color:#66d9ef>done</span> &gt; zunda.log
</code></pre></div><p>これは問題の1行野郎を1000回実行し、その出力結果を<code>zunda.log</code>に記録するというものです。実行後に生成される<code>zunda.log</code>の内容は膨大なものになるため、とりあえず前の30行だけ見てみましょう(<code>head -n 30 zunda.log</code>)。</p><pre><code>poyayou
sleepy
poyayou
sleepy
tamakatsu
sleepy
sushi
sleepy
tamakatsu
sleepy
trick
happy halloween
treat
happy halloween
poyayou
sleepy
poyayou
sleepy
poyayou
sleepy
sushi
sleepy
sushi
sleepy
tamakatsu
sleepy
treat
happy halloween
treat
happy halloween
</code></pre><p>trick, treat, sushi, poyayou, tamakatsuがランダムに生成され、trickまたはtreatの場合は続いてhappy halloweenが、それ以外の場合はsleepyが出力されている状態が確認できますね。ちなみにそれぞれの単語の出現回数は次のようなコマンドで確認することができます。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat zunda.log | sort | uniq -c | sort -n
</code></pre></div><p>この実行結果は以下の通りで、それぞれの単語がある程度均等に出力されていることが分かります。また$165+179+196+223+237=1000$となり、1000回ちょうど実行されていることも確認可能です。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>    <span style=color:#ae81ff>165</span> trick
    <span style=color:#ae81ff>179</span> sushi
    <span style=color:#ae81ff>196</span> treat
    <span style=color:#ae81ff>223</span> poyayou
    <span style=color:#ae81ff>237</span> tamakatsu
    <span style=color:#ae81ff>361</span> happy halloween
    <span style=color:#ae81ff>639</span> sleepy
</code></pre></div><div class=blog-tags><a href=https://nekotheshadow.github.io/qiita-backup/tags/bash/>Bash</a>&nbsp;</div></article><ul class="pager blog-pager"><li class=previous><a href=https://nekotheshadow.github.io/qiita-backup/blog/acc773ef71b3312075e7/ data-toggle=tooltip data-placement=top title="ずんだの表見出し++問題 SQL 編">&larr; Previous Post</a></li><li class=next><a href=https://nekotheshadow.github.io/qiita-backup/blog/8d7c77587519d357e1dd/ data-toggle=tooltip data-placement=top title="ずんだのMARQUEE問題 C#編">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"></ul><p class="credits copyright text-muted">&nbsp;&bull;&nbsp;&copy;
2022
&nbsp;&bull;&nbsp;
<a href=https://nekotheshadow.github.io/qiita-backup>Qiita Backup</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.74.3</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=https://nekotheshadow.github.io/qiita-backup/js/main.js></script><script>renderMathInElement(document.body);</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://nekotheshadow.github.io/qiita-backup/js/load-photoswipe.js></script></body></html>