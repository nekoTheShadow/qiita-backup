{"rendered_body":"<p>Apache POIを使ってセルにリンクを設定する場合のサンプルを以下に示します。</p>\n\n<div class=\"code-frame\" data-lang=\"java\"><div class=\"highlight\"><pre><code><span class=\"nc\">Workbook</span> <span class=\"n\">workbook</span> <span class=\"o\">=</span> <span class=\"o\">...;</span>\n<span class=\"nc\">Cell</span> <span class=\"n\">cell</span> <span class=\"o\">=</span> <span class=\"o\">...;</span>\n\n<span class=\"c1\">// セルにハイパーリンクを設定する</span>\n<span class=\"nc\">Hyperlink</span> <span class=\"n\">hyperlink</span> <span class=\"o\">=</span> <span class=\"n\">workbook</span><span class=\"o\">.</span><span class=\"na\">getCreationHelper</span><span class=\"o\">().</span><span class=\"na\">createHyperlink</span><span class=\"o\">(</span><span class=\"nc\">HyperlinkType</span><span class=\"o\">.</span><span class=\"na\">DOCUMENT</span><span class=\"o\">);</span>\n<span class=\"n\">hyperlink</span><span class=\"o\">.</span><span class=\"na\">setAddress</span><span class=\"o\">(</span><span class=\"s\">\"destination!A1\"</span><span class=\"o\">);</span>\n<span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"na\">setHyperlink</span><span class=\"o\">(</span><span class=\"n\">hyperlink</span><span class=\"o\">);</span>\n\n<span class=\"c1\">// セルに値を設定する</span>\n<span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"na\">setCellValue</span><span class=\"o\">(</span><span class=\"s\">\"destinationシートのA1へのリンク\"</span><span class=\"o\">);</span>\n\n<span class=\"c1\">// 文字色を青色にして、アンダーラインを設定する</span>\n<span class=\"nc\">CellStyle</span> <span class=\"n\">cellStyle</span> <span class=\"o\">=</span> <span class=\"n\">workbook</span><span class=\"o\">.</span><span class=\"na\">createCellStyle</span><span class=\"o\">();</span>\n<span class=\"nc\">Font</span> <span class=\"n\">font</span> <span class=\"o\">=</span> <span class=\"n\">workbook</span><span class=\"o\">.</span><span class=\"na\">createFont</span><span class=\"o\">();</span>\n<span class=\"n\">font</span><span class=\"o\">.</span><span class=\"na\">setColor</span><span class=\"o\">(</span><span class=\"nc\">IndexedColors</span><span class=\"o\">.</span><span class=\"na\">BLUE</span><span class=\"o\">.</span><span class=\"na\">getIndex</span><span class=\"o\">());</span>\n<span class=\"n\">font</span><span class=\"o\">.</span><span class=\"na\">setUnderline</span><span class=\"o\">(</span><span class=\"nc\">Font</span><span class=\"o\">.</span><span class=\"na\">U_SINGLE</span><span class=\"o\">);</span>\n<span class=\"n\">cellStyle</span><span class=\"o\">.</span><span class=\"na\">setFont</span><span class=\"o\">(</span><span class=\"n\">font</span><span class=\"o\">);</span>\n<span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"na\">setCellStyle</span><span class=\"o\">(</span><span class=\"n\">cellStyle</span><span class=\"o\">);</span>\n</code></pre></div></div>\n\n<p>Excelではリンクを自動設定すると、文字色が青色になってアンダーラインが設定されますが、POIでは自動設定されないため、ここもコーディングする必要があります。したがって文字色とアンダーラインの設定が不要な場合は、サンプルの最後のほうは無視してOKです。</p>\n\n<p>なおこのサンプルを実行したイメージは以下のようになります。</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/ad902b741ada047e55d457b55efc00308b84d18b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f64333538393235342d343330312d656237372d653336332d3437636538313339316137622e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fd3589254-4301-eb77-e363-47ce81391a7b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=58c65f3c0a821b9f19a6396e913a7620\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/d3589254-4301-eb77-e363-47ce81391a7b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fd3589254-4301-eb77-e363-47ce81391a7b.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=57fda56bc2d93c3d241832c2357a6c2a 1x\" loading=\"lazy\"></a></p>\n\n<p><strong>環境情報: pom.xml抜粋</strong></p>\n\n<div class=\"code-frame\" data-lang=\"xml\"><div class=\"highlight\"><pre><code><span class=\"nt\">&lt;properties&gt;</span>\n    <span class=\"nt\">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class=\"nt\">&lt;/project.build.sourceEncoding&gt;</span>\n    <span class=\"nt\">&lt;maven.compiler.target&gt;</span>11<span class=\"nt\">&lt;/maven.compiler.target&gt;</span>\n    <span class=\"nt\">&lt;maven.compiler.source&gt;</span>11<span class=\"nt\">&lt;/maven.compiler.source&gt;</span>\n<span class=\"nt\">&lt;/properties&gt;</span>\n\n<span class=\"nt\">&lt;dependencies&gt;</span>\n    <span class=\"c\">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi --&gt;</span>\n    <span class=\"nt\">&lt;dependency&gt;</span>\n        <span class=\"nt\">&lt;groupId&gt;</span>org.apache.poi<span class=\"nt\">&lt;/groupId&gt;</span>\n        <span class=\"nt\">&lt;artifactId&gt;</span>poi<span class=\"nt\">&lt;/artifactId&gt;</span>\n        <span class=\"nt\">&lt;version&gt;</span>5.1.0<span class=\"nt\">&lt;/version&gt;</span>\n    <span class=\"nt\">&lt;/dependency&gt;</span>\n<span class=\"nt\">&lt;/dependencies&gt;</span>\n</code></pre></div></div>\n","body":"Apache POIを使ってセルにリンクを設定する場合のサンプルを以下に示します。\n\n```java\nWorkbook workbook = ...;\nCell cell = ...;\n\n// セルにハイパーリンクを設定する\nHyperlink hyperlink = workbook.getCreationHelper().createHyperlink(HyperlinkType.DOCUMENT);\nhyperlink.setAddress(\"destination!A1\");\ncell.setHyperlink(hyperlink);\n\n// セルに値を設定する\ncell.setCellValue(\"destinationシートのA1へのリンク\");\n\n// 文字色を青色にして、アンダーラインを設定する\nCellStyle cellStyle = workbook.createCellStyle();\nFont font = workbook.createFont();\nfont.setColor(IndexedColors.BLUE.getIndex());\nfont.setUnderline(Font.U_SINGLE);\ncellStyle.setFont(font);\ncell.setCellStyle(cellStyle);\n```\n\nExcelではリンクを自動設定すると、文字色が青色になってアンダーラインが設定されますが、POIでは自動設定されないため、ここもコーディングする必要があります。したがって文字色とアンダーラインの設定が不要な場合は、サンプルの最後のほうは無視してOKです。\n\nなおこのサンプルを実行したイメージは以下のようになります。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/d3589254-4301-eb77-e363-47ce81391a7b.png)\n\n__環境情報: pom.xml抜粋__\n\n```xml\n<properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n    <maven.compiler.target>11</maven.compiler.target>\n    <maven.compiler.source>11</maven.compiler.source>\n</properties>\n\n<dependencies>\n    <!-- https://mvnrepository.com/artifact/org.apache.poi/poi -->\n    <dependency>\n        <groupId>org.apache.poi</groupId>\n        <artifactId>poi</artifactId>\n        <version>5.1.0</version>\n    </dependency>\n</dependencies>\n```\n","coediting":false,"comments_count":0,"created_at":"2021-11-23T14:34:27+09:00","group":null,"id":"5ea378e90f618902fc18","likes_count":0,"private":false,"reactions_count":0,"tags":[{"name":"Java","versions":[]},{"name":"POI","versions":[]}],"title":"Apache POIを使ってセルにリンクを設定する","updated_at":"2021-11-23T14:34:27+09:00","url":"https://qiita.com/neko_the_shadow/items/5ea378e90f618902fc18","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":36,"github_login_name":null,"id":"neko_the_shadow","items_count":197,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null,"team_membership":null}