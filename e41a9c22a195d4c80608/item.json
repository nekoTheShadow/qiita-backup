{"rendered_body":"<p data-sourcepos=\"1:1-1:144\">VBAでキャプチャグループにマッチした文字列を取得したい場合、MatchオブジェクトのSubMatchesを利用します。</p>\n<p data-sourcepos=\"3:1-3:206\">例) YYYY/MM/DDにマッチする文字列、およびYYYY、MM、DDそれぞれにマッチする文字列をキャプチャグループを含む正規表現で取得し、コンソールに表示する。</p>\n<div class=\"code-frame\" data-lang=\"vb\" data-sourcepos=\"5:1-37:3\"><div class=\"highlight\"><pre><code><span class=\"c1\">' 変数宣言</span>\n<span class=\"k\">Dim</span> <span class=\"nv\">line</span> <span class=\"ow\">As</span> <span class=\"kt\">String</span>\n<span class=\"k\">Dim</span> <span class=\"nv\">re</span> <span class=\"ow\">As</span> <span class=\"n\">RegExp</span>\n<span class=\"k\">Dim</span> <span class=\"nv\">mc</span> <span class=\"ow\">As</span> <span class=\"n\">MatchCollection</span>\n<span class=\"k\">Dim</span> <span class=\"nv\">m</span> <span class=\"ow\">As</span> <span class=\"n\">Match</span>\n<span class=\"k\">Dim</span> <span class=\"nv\">i</span> <span class=\"ow\">As</span> <span class=\"kt\">Long</span>\n<span class=\"k\">Dim</span> <span class=\"nv\">j</span> <span class=\"ow\">As</span> <span class=\"kt\">Long</span>\n\n<span class=\"c1\">' 検索対象の文字列を設定する</span>\n<span class=\"n\">line</span> <span class=\"o\">=</span> <span class=\"s\">\"わたしの誕生日は2000/01/02、彼女の誕生日は2001/03/04です\"</span>\n\n<span class=\"c1\">' 正規表現オブジェクトを作成する</span>\n<span class=\"k\">Set</span> <span class=\"n\">re</span> <span class=\"o\">=</span> <span class=\"k\">New</span> <span class=\"n\">RegExp</span>\n<span class=\"n\">re</span><span class=\"p\">.</span><span class=\"n\">Global</span> <span class=\"o\">=</span> <span class=\"k\">True</span>\n<span class=\"n\">re</span><span class=\"p\">.</span><span class=\"n\">Pattern</span> <span class=\"o\">=</span> <span class=\"s\">\"([0-9]{4})/([0-9]{2})/([0-9]{2})\"</span>\n\n<span class=\"c1\">' 正規表現による検索を実行する</span>\n<span class=\"k\">Set</span> <span class=\"n\">mc</span> <span class=\"o\">=</span> <span class=\"n\">re</span><span class=\"p\">.</span><span class=\"n\">Execute</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"p\">)</span>\n\n<span class=\"c1\">' 検索結果を表示する</span>\n<span class=\"k\">For</span> <span class=\"n\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> <span class=\"k\">To</span> <span class=\"n\">mc</span><span class=\"p\">.</span><span class=\"n\">Count</span> <span class=\"o\">-</span> <span class=\"mi\">1</span>\n    <span class=\"k\">Set</span> <span class=\"n\">m</span> <span class=\"o\">=</span> <span class=\"n\">mc</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n    \n    <span class=\"c1\">' マッチした文字列全体を表示する</span>\n    <span class=\"n\">Debug</span><span class=\"p\">.</span><span class=\"n\">Print</span> <span class=\"n\">m</span>\n    \n    <span class=\"c1\">' キャプチャグループにマッチした文字列を表示する</span>\n    <span class=\"k\">For</span> <span class=\"n\">j</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> <span class=\"k\">To</span> <span class=\"n\">m</span><span class=\"p\">.</span><span class=\"n\">SubMatches</span><span class=\"p\">.</span><span class=\"n\">Count</span> <span class=\"o\">-</span> <span class=\"mi\">1</span>\n        <span class=\"n\">Debug</span><span class=\"p\">.</span><span class=\"n\">Print</span> <span class=\"n\">m</span><span class=\"p\">.</span><span class=\"n\">SubMatches</span><span class=\"p\">(</span><span class=\"n\">j</span><span class=\"p\">)</span>\n    <span class=\"k\">Next</span> <span class=\"n\">j</span>\n<span class=\"k\">Next</span> <span class=\"n\">i</span>\n</code></pre></div></div>\n<p data-sourcepos=\"39:1-39:90\">これを実行すると、コンソールは次の通りに表示されるはずです。</p>\n<div class=\"code-frame\" data-lang=\"text\" data-sourcepos=\"41:1-50:3\"><div class=\"highlight\"><pre><code>2000/01/02\n2000\n01\n02\n2001/03/04\n2001\n03\n04\n</code></pre></div></div>\n<p data-sourcepos=\"52:1-52:16\"><strong>環境情報</strong></p>\n<p data-sourcepos=\"54:1-54:121\"><a href=\"https://camo.qiitausercontent.com/b95e7bdc76854e9cb943743a11ddfd700ccde5ae/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f34633664353237322d356563372d633130652d653535332d3630343036353238346637362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F4c6d5272-5ec7-c10e-e553-604065284f76.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8c776dee95c7955f406bced2b074e166\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/4c6d5272-5ec7-c10e-e553-604065284f76.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F4c6d5272-5ec7-c10e-e553-604065284f76.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ea8d4a6e53300bfb793b774230b239cb 1x\" loading=\"lazy\"></a></p>\n","body":"VBAでキャプチャグループにマッチした文字列を取得したい場合、MatchオブジェクトのSubMatchesを利用します。\n\n例) YYYY/MM/DDにマッチする文字列、およびYYYY、MM、DDそれぞれにマッチする文字列をキャプチャグループを含む正規表現で取得し、コンソールに表示する。\n\n```vb\n' 変数宣言\nDim line As String\nDim re As RegExp\nDim mc As MatchCollection\nDim m As Match\nDim i As Long\nDim j As Long\n\n' 検索対象の文字列を設定する\nline = \"わたしの誕生日は2000/01/02、彼女の誕生日は2001/03/04です\"\n\n' 正規表現オブジェクトを作成する\nSet re = New RegExp\nre.Global = True\nre.Pattern = \"([0-9]{4})/([0-9]{2})/([0-9]{2})\"\n\n' 正規表現による検索を実行する\nSet mc = re.Execute(line)\n\n' 検索結果を表示する\nFor i = 0 To mc.Count - 1\n    Set m = mc(i)\n    \n    ' マッチした文字列全体を表示する\n    Debug.Print m\n    \n    ' キャプチャグループにマッチした文字列を表示する\n    For j = 0 To m.SubMatches.Count - 1\n        Debug.Print m.SubMatches(j)\n    Next j\nNext i\n```\n\nこれを実行すると、コンソールは次の通りに表示されるはずです。\n\n```\n2000/01/02\n2000\n01\n02\n2001/03/04\n2001\n03\n04\n```\n\n**環境情報**\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/4c6d5272-5ec7-c10e-e553-604065284f76.png)\n","coediting":false,"comments_count":0,"created_at":"2023-05-19T19:08:53+09:00","group":null,"id":"e41a9c22a195d4c80608","likes_count":0,"private":false,"reactions_count":0,"stocks_count":0,"tags":[{"name":"VBA","versions":[]}],"title":"キャプチャグループにマッチした文字列を取得したい","updated_at":"2023-05-19T19:10:37+09:00","url":"https://qiita.com/neko_the_shadow/items/e41a9c22a195d4c80608","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":37,"github_login_name":null,"id":"neko_the_shadow","items_count":216,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://github.com/nekoTheShadow"},"page_views_count":455,"team_membership":null,"organization_url_name":null,"slide":false}