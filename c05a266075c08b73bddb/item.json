{"rendered_body":"<p>実をいうとJavaScriptは苦手なのですが、しかしそうはいっていられないのがシステムエンジニア稼業。苦手不得意未経験関係なく、どんな無茶ぶりにもこたえねばならならない悲しみ(´・ω・｀)</p>\n\n<p>それはさておき、業務において「<strong>ペーストが実行されたとき、そのペーストされた値をJavaScript上で制御したい</strong>」ということがありました。JavaScript苦手勢なわたしはたいへん苦労したので、後学のためにもサンプルコードを記事にしておきたいと思います。</p>\n\n<div class=\"code-frame\" data-lang=\"html\">\n<div class=\"code-lang\"><span class=\"bold\">paste.html</span></div>\n<div class=\"highlight\"><pre><span class=\"cp\">&lt;!DOCTYPE html&gt;</span>\n<span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;head&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">charset=</span><span class=\"s\">\"UTF-8\"</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;title&gt;</span>after paste event test<span class=\"nt\">&lt;/title&gt;</span>\n<span class=\"nt\">&lt;/head&gt;</span>\n\n<span class=\"nt\">&lt;body&gt;</span>\n    <span class=\"nt\">&lt;form&gt;</span>\n        <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">\"text\"</span> <span class=\"na\">id=</span><span class=\"s\">\"test\"</span> <span class=\"nt\">/&gt;</span>\n    <span class=\"nt\">&lt;/form&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n\n<span class=\"nt\">&lt;script&gt;</span>\n<span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">onload</span> <span class=\"o\">=</span> <span class=\"kd\">function</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n    <span class=\"kd\">var</span> <span class=\"nx\">element</span> <span class=\"o\">=</span> <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">getElementById</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">test</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n    <span class=\"nx\">element</span><span class=\"p\">.</span><span class=\"nx\">addEventListener</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">paste</span><span class=\"dl\">\"</span><span class=\"p\">,</span> <span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">event</span><span class=\"p\">){</span>\n        <span class=\"nx\">setTimeout</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">){</span>\n            <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">alert</span><span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">.</span><span class=\"nx\">target</span><span class=\"p\">.</span><span class=\"nx\">value</span><span class=\"p\">);</span>\n        <span class=\"p\">},</span> <span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"nx\">event</span><span class=\"p\">);</span>\n    <span class=\"p\">});</span>\n<span class=\"p\">}</span>\n<span class=\"nt\">&lt;/script&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</pre></div>\n</div>\n\n<p>これを実際に実行してみると、テキストボックスに対してペーストを行った瞬間にテキストボックスの内容=ペーストした内容がポップアップされることがわかります。</p>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2F1a03d812-f6cc-f1e4-2772-8f80598b525f.jpeg?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e910f50209092e0c6f2f3f9627a78da8\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2F1a03d812-f6cc-f1e4-2772-8f80598b525f.jpeg?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=e910f50209092e0c6f2f3f9627a78da8\" alt=\"paste.jpg\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/105859/1a03d812-f6cc-f1e4-2772-8f80598b525f.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F105859%2F1a03d812-f6cc-f1e4-2772-8f80598b525f.jpeg?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f975cee99fd6b3aa52f98a5bdac16a9d 1x\" loading=\"lazy\"></a></p>\n\n<p>さてここに示されたサンプルにおいてもっとも重要な部分が次のjavascriptのソースコードです。</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><span class=\"nx\">element</span><span class=\"p\">.</span><span class=\"nx\">addEventListener</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">paste</span><span class=\"dl\">\"</span><span class=\"p\">,</span> <span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">event</span><span class=\"p\">){</span>\n    <span class=\"nx\">setTimeout</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">){</span>\n        <span class=\"nb\">window</span><span class=\"p\">.</span><span class=\"nx\">alert</span><span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">.</span><span class=\"nx\">target</span><span class=\"p\">.</span><span class=\"nx\">value</span><span class=\"p\">);</span>\n    <span class=\"p\">},</span> <span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"nx\">event</span><span class=\"p\">);</span>\n<span class=\"p\">});</span>\n</pre></div></div>\n\n<p><code>paste</code>イベントが発火するのは意外にも「ペーストされる直前」。よって「ペーストされた後」の状態を取得したいという場合には<code>setTimeout</code>を利用して、実際的な処理の実行を「ペースト直後」にまで遅らせてやる必要があるということですね(´・ω・｀)</p>\n","body":"\n実をいうとJavaScriptは苦手なのですが、しかしそうはいっていられないのがシステムエンジニア稼業。苦手不得意未経験関係なく、どんな無茶ぶりにもこたえねばならならない悲しみ(´・ω・｀)\n\nそれはさておき、業務において「__ペーストが実行されたとき、そのペーストされた値をJavaScript上で制御したい__」ということがありました。JavaScript苦手勢なわたしはたいへん苦労したので、後学のためにもサンプルコードを記事にしておきたいと思います。\n\n```html:paste.html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\" />\n    <title>after paste event test</title>\n</head>\n\n<body>\n    <form>\n        <input type=\"text\" id=\"test\" />\n    </form>\n</body>\n\n<script>\nwindow.onload = function() {\n    var element = document.getElementById(\"test\");\n    element.addEventListener(\"paste\", function(event){\n        setTimeout(function(e){\n            window.alert(e.target.value);\n        }, 100, event);\n    });\n}\n</script>\n</html>\n```\n\nこれを実際に実行してみると、テキストボックスに対してペーストを行った瞬間にテキストボックスの内容=ペーストした内容がポップアップされることがわかります。\n\n![paste.jpg](https://qiita-image-store.s3.amazonaws.com/0/105859/1a03d812-f6cc-f1e4-2772-8f80598b525f.jpeg)\n\nさてここに示されたサンプルにおいてもっとも重要な部分が次のjavascriptのソースコードです。\n\n```js\nelement.addEventListener(\"paste\", function(event){\n    setTimeout(function(e){\n        window.alert(e.target.value);\n    }, 100, event);\n});\n```\n\n`paste`イベントが発火するのは意外にも「ペーストされる直前」。よって「ペーストされた後」の状態を取得したいという場合には`setTimeout`を利用して、実際的な処理の実行を「ペースト直後」にまで遅らせてやる必要があるということですね(´・ω・｀)\n\n","coediting":false,"comments_count":1,"created_at":"2017-06-19T23:30:21+09:00","group":null,"id":"c05a266075c08b73bddb","likes_count":8,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]}],"title":"ペースト実行時にそのペーストされた値を取得したい","updated_at":"2017-06-19T23:30:21+09:00","url":"https://qiita.com/neko_the_shadow/items/c05a266075c08b73bddb","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":33,"github_login_name":null,"id":"neko_the_shadow","items_count":168,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null}