{"rendered_body":"<p>Excelの列の幅の自動調整に相当することをApache POIで実現したい場合、<code>Sheet.autoSizeColumn</code>を利用すると良いです。ただし、とくに日本語が混ざっている場合、<code>Sheet.autoSizeColumn</code>がうまく列の幅を調整してくれないことがあります。これを回避したい場合、自動調整したい列のセルのフォントを日本語対応のものに設定してやると、想定通り動くようです。</p>\n\n<p>以下はそのサンプルになります。</p>\n\n<div class=\"code-frame\" data-lang=\"java\"><div class=\"highlight\"><pre><code><span class=\"nc\">Workbook</span> <span class=\"n\">workbook</span> <span class=\"o\">=</span> <span class=\"o\">...;</span>\n<span class=\"nc\">Sheet</span> <span class=\"n\">sheet</span> <span class=\"o\">=</span> <span class=\"o\">...;</span>\n\n<span class=\"c1\">// 幅の自動調整をしたい列のセルのフォントを日本語対応のものに設定する。</span>\n<span class=\"c1\">// (ここでは例としてYu Gothic UIを使う)</span>\n<span class=\"nc\">Cell</span> <span class=\"n\">cell</span> <span class=\"o\">=</span> <span class=\"o\">...;</span>\n<span class=\"nc\">CellStyle</span> <span class=\"n\">cellStyle</span> <span class=\"o\">=</span> <span class=\"n\">workbook</span><span class=\"o\">.</span><span class=\"na\">createCellStyle</span><span class=\"o\">();</span>\n<span class=\"nc\">Font</span> <span class=\"n\">font</span> <span class=\"o\">=</span> <span class=\"n\">workbook</span><span class=\"o\">.</span><span class=\"na\">createFont</span><span class=\"o\">();</span>\n<span class=\"n\">font</span><span class=\"o\">.</span><span class=\"na\">setFontName</span><span class=\"o\">(</span><span class=\"s\">\"Yu Gothic UI\"</span><span class=\"o\">);</span>\n<span class=\"n\">cellStyle</span><span class=\"o\">.</span><span class=\"na\">setFont</span><span class=\"o\">(</span><span class=\"n\">font</span><span class=\"o\">);</span>\n<span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"na\">setCellStyle</span><span class=\"o\">(</span><span class=\"n\">cellStyle</span><span class=\"o\">);</span>\n\n<span class=\"c1\">// 幅の自動調整を行う (ここでは例としてB列とする)</span>\n<span class=\"nc\">CellReference</span> <span class=\"n\">cellReference</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nc\">CellReference</span><span class=\"o\">(</span><span class=\"s\">\"B\"</span><span class=\"o\">);</span>\n<span class=\"n\">sheet</span><span class=\"o\">.</span><span class=\"na\">autoSizeColumn</span><span class=\"o\">(</span><span class=\"n\">cellReference</span><span class=\"o\">.</span><span class=\"na\">getCol</span><span class=\"o\">());</span>\n</code></pre></div></div>\n\n<p><strong>環境情報: pom.xml抜粋</strong></p>\n\n<div class=\"code-frame\" data-lang=\"xml\"><div class=\"highlight\"><pre><code><span class=\"nt\">&lt;properties&gt;</span>\n    <span class=\"nt\">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class=\"nt\">&lt;/project.build.sourceEncoding&gt;</span>\n    <span class=\"nt\">&lt;maven.compiler.target&gt;</span>11<span class=\"nt\">&lt;/maven.compiler.target&gt;</span>\n    <span class=\"nt\">&lt;maven.compiler.source&gt;</span>11<span class=\"nt\">&lt;/maven.compiler.source&gt;</span>\n<span class=\"nt\">&lt;/properties&gt;</span>\n\n<span class=\"nt\">&lt;dependencies&gt;</span>\n    <span class=\"c\">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi --&gt;</span>\n    <span class=\"nt\">&lt;dependency&gt;</span>\n        <span class=\"nt\">&lt;groupId&gt;</span>org.apache.poi<span class=\"nt\">&lt;/groupId&gt;</span>\n        <span class=\"nt\">&lt;artifactId&gt;</span>poi<span class=\"nt\">&lt;/artifactId&gt;</span>\n        <span class=\"nt\">&lt;version&gt;</span>5.1.0<span class=\"nt\">&lt;/version&gt;</span>\n    <span class=\"nt\">&lt;/dependency&gt;</span>\n<span class=\"nt\">&lt;/dependencies&gt;</span>\n</code></pre></div></div>\n","body":"Excelの列の幅の自動調整に相当することをApache POIで実現したい場合、`Sheet.autoSizeColumn`を利用すると良いです。ただし、とくに日本語が混ざっている場合、`Sheet.autoSizeColumn`がうまく列の幅を調整してくれないことがあります。これを回避したい場合、自動調整したい列のセルのフォントを日本語対応のものに設定してやると、想定通り動くようです。\n\n以下はそのサンプルになります。\n\n```java\nWorkbook workbook = ...;\nSheet sheet = ...;\n\n// 幅の自動調整をしたい列のセルのフォントを日本語対応のものに設定する。\n// (ここでは例としてYu Gothic UIを使う)\nCell cell = ...;\nCellStyle cellStyle = workbook.createCellStyle();\nFont font = workbook.createFont();\nfont.setFontName(\"Yu Gothic UI\");\ncellStyle.setFont(font);\ncell.setCellStyle(cellStyle);\n\n// 幅の自動調整を行う (ここでは例としてB列とする)\nCellReference cellReference = new CellReference(\"B\");\nsheet.autoSizeColumn(cellReference.getCol());\n```\n\n__環境情報: pom.xml抜粋__\n\n```xml\n<properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n    <maven.compiler.target>11</maven.compiler.target>\n    <maven.compiler.source>11</maven.compiler.source>\n</properties>\n\n<dependencies>\n    <!-- https://mvnrepository.com/artifact/org.apache.poi/poi -->\n    <dependency>\n        <groupId>org.apache.poi</groupId>\n        <artifactId>poi</artifactId>\n        <version>5.1.0</version>\n    </dependency>\n</dependencies>\n```\n","coediting":false,"comments_count":0,"created_at":"2021-11-23T14:36:03+09:00","group":null,"id":"2dcf0c8275317135733b","likes_count":1,"private":false,"reactions_count":0,"stocks_count":1,"tags":[{"name":"Java","versions":[]},{"name":"POI","versions":[]}],"title":"Apache POIを使って列の幅の自動調整を行う","updated_at":"2021-11-23T14:36:03+09:00","url":"https://qiita.com/neko_the_shadow/items/2dcf0c8275317135733b","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":35,"github_login_name":null,"id":"neko_the_shadow","items_count":210,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":4276,"team_membership":null,"organization_url_name":null}