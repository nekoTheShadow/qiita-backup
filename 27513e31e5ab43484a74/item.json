{"rendered_body":"<p><a href=\"https://codeiq.jp/q/2831\" rel=\"nofollow noopener\" target=\"_blank\">CodeIQ「『アフター・ドット』問題」</a>の掲載期限が終了したということで、提出コードを公開したいと思います。なお詳しい内容については、広大なネットの海を探してください(´・ω・`)</p>\n\n<div class=\"code-frame\" data-lang=\"rb\"><div class=\"highlight\"><pre><code>\n<span class=\"k\">class</span> <span class=\"nc\">Solver</span>\n    <span class=\"k\">def</span> <span class=\"nf\">initialize</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n        <span class=\"vi\">@n</span> <span class=\"o\">=</span> <span class=\"n\">n</span>\n    <span class=\"k\">end</span>\n\n    <span class=\"c1\"># bをただひとつに決めたとき、(a / b)が有限小数となるaの数を求める</span>\n    <span class=\"k\">def</span> <span class=\"nf\">g</span><span class=\"p\">(</span><span class=\"n\">b</span><span class=\"p\">)</span>\n        <span class=\"n\">b</span> <span class=\"o\">/=</span> <span class=\"mi\">2</span> <span class=\"k\">while</span> <span class=\"n\">b</span> <span class=\"o\">%</span> <span class=\"mi\">2</span> <span class=\"o\">==</span> <span class=\"mi\">0</span>\n        <span class=\"n\">b</span> <span class=\"o\">/=</span> <span class=\"mi\">5</span> <span class=\"k\">while</span> <span class=\"n\">b</span> <span class=\"o\">%</span> <span class=\"mi\">5</span> <span class=\"o\">==</span> <span class=\"mi\">0</span>\n        <span class=\"vi\">@n</span> <span class=\"o\">/</span> <span class=\"n\">b</span>\n    <span class=\"k\">end</span>\n\n    <span class=\"c1\"># 問題中のF(n)。</span>\n    <span class=\"k\">def</span> <span class=\"nf\">f</span>\n        <span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"o\">..</span><span class=\"vi\">@n</span><span class=\"p\">).</span><span class=\"nf\">reduce</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">){</span><span class=\"o\">|</span><span class=\"n\">sum</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"o\">|</span> <span class=\"n\">sum</span> <span class=\"o\">+</span> <span class=\"nb\">self</span><span class=\"p\">.</span><span class=\"nf\">g</span><span class=\"p\">(</span><span class=\"n\">b</span><span class=\"p\">)}</span>\n    <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n\n<span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"nb\">gets</span><span class=\"p\">.</span><span class=\"nf\">to_i</span>\n<span class=\"n\">solver</span> <span class=\"o\">=</span> <span class=\"no\">Solver</span><span class=\"p\">.</span><span class=\"nf\">new</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n\n<span class=\"nb\">p</span> <span class=\"n\">solver</span><span class=\"p\">.</span><span class=\"nf\">f</span>\n</code></pre></div></div>\n\n<p>$1 \\leq a \\leq n$および$1 \\leq b \\leq n$を満たす整数$a$と$b$について、$\\frac{a}{b}$が有限小数になる条件は<strong>「$\\frac{a}{b}$を既約分数にしたとき、その分母が$2$と$5$以外の素因数を持たないこと」</strong>です。ここで$b$を素因数分解したとき、$2$と$5$以外の素因数を掛け合わせたものを$x$とします。いいかえれば$b$を$2$と$5$で割れるだけ割った、その残りが$x$となります。</p>\n\n<p>$a$が約数として$x$を持つとき、いいかえれば$a$が$x$で割り切れるとき、aとbは次のように表すことができます。</p>\n\n<div class=\"code-frame\" data-lang=\"math\"><div class=\"highlight\"><pre><code>\\begin{align}\na &amp;= n \\times x \\\\\nb &amp;= 2^i \\times 5^j \\times x \n\\end{align}\n\\\\\n(nは1以上の整数,iとjは0以上の整数)\n</code></pre></div></div>\n\n<p>よって$\\frac{a}{b} = \\frac{n}{2^i \\times 5^j}$であり、その分母は$2$と$5$以外の素因数を持ちませんから、有限小数です。要するに$\\frac{a}{b}$が有限小数となる条件は<strong>「$a$が$x$の倍数であること」</strong>となります。</p>\n\n<p>以上の性質を利用して、本問を解くわけですが、その手順は以下のようになります。</p>\n\n<ol>\n<li>$b$をただひとつに固定する</li>\n<li>$2$と$5$で$b$を割りつくすことにより$x$を求める</li>\n<li>$1$以上$n$以下の整数に含まれる$x$の倍数の総数をもとめる。\n\n<ol>\n<li>これを$G(b)$とする</li>\n</ol>\n</li>\n<li>$b$を$1$から$n$の範囲で動かしながら、$G(b)$の合計値を求める</li>\n</ol>\n\n<hr>\n\n<p>今回の問題については、コードゴルフ勢と高速化勢が(いい意味で)暴れまわっていたので、公開されたコードを読むのがちょっと楽しみです。そういう「特殊部隊」と比べると、わたしの解答コードは普通……。すみません(´・ω・`)</p>\n","body":"[CodeIQ「『アフター・ドット』問題」](https://codeiq.jp/q/2831)の掲載期限が終了したということで、提出コードを公開したいと思います。なお詳しい内容については、広大なネットの海を探してください(´・ω・`)\n\n```rb\n\nclass Solver\n    def initialize(n)\n        @n = n\n    end\n\n    # bをただひとつに決めたとき、(a / b)が有限小数となるaの数を求める\n    def g(b)\n        b /= 2 while b % 2 == 0\n        b /= 5 while b % 5 == 0\n        @n / b\n    end\n\n    # 問題中のF(n)。\n    def f\n        (1..@n).reduce(0){|sum, b| sum + self.g(b)}\n    end\nend\n\nn = gets.to_i\nsolver = Solver.new(n)\n\np solver.f\n```\n\n$1 \\leq a \\leq n$および$1 \\leq b \\leq n$を満たす整数$a$と$b$について、$\\frac{a}{b}$が有限小数になる条件は__「$\\frac{a}{b}$を既約分数にしたとき、その分母が$2$と$5$以外の素因数を持たないこと」__です。ここで$b$を素因数分解したとき、$2$と$5$以外の素因数を掛け合わせたものを$x$とします。いいかえれば$b$を$2$と$5$で割れるだけ割った、その残りが$x$となります。\n\n$a$が約数として$x$を持つとき、いいかえれば$a$が$x$で割り切れるとき、aとbは次のように表すことができます。\n\n```math\n\\begin{align}\na &= n \\times x \\\\\nb &= 2^i \\times 5^j \\times x \n\\end{align}\n\\\\\n(nは1以上の整数,iとjは0以上の整数)\n```\n\nよって$\\frac{a}{b} = \\frac{n}{2^i \\times 5^j}$であり、その分母は$2$と$5$以外の素因数を持ちませんから、有限小数です。要するに$\\frac{a}{b}$が有限小数となる条件は__「$a$が$x$の倍数であること」__となります。\n\n以上の性質を利用して、本問を解くわけですが、その手順は以下のようになります。\n\n1. $b$をただひとつに固定する\n2. $2$と$5$で$b$を割りつくすことにより$x$を求める\n3. $1$以上$n$以下の整数に含まれる$x$の倍数の総数をもとめる。\n    4. これを$G(b)$とする\n4. $b$を$1$から$n$の範囲で動かしながら、$G(b)$の合計値を求める\n\n***\n\n今回の問題については、コードゴルフ勢と高速化勢が(いい意味で)暴れまわっていたので、公開されたコードを読むのがちょっと楽しみです。そういう「特殊部隊」と比べると、わたしの解答コードは普通……。すみません(´・ω・`)\n","coediting":false,"comments_count":0,"created_at":"2016-07-07T23:13:33+09:00","group":null,"id":"27513e31e5ab43484a74","likes_count":2,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"codeiq","versions":[]}],"title":"CodeIQ「『アフター・ドット』問題」に参加しました","updated_at":"2016-07-07T23:22:59+09:00","url":"https://qiita.com/neko_the_shadow/items/27513e31e5ab43484a74","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":36,"github_login_name":null,"id":"neko_the_shadow","items_count":194,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null,"team_membership":null}