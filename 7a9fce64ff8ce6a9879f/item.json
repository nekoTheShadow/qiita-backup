{"rendered_body":"<p data-sourcepos=\"1:1-1:106\">SSMSでクエリ結果をファイルに保存したい場合、以下の手順で設定を行います。</p>\n<p data-sourcepos=\"3:1-3:50\">① ツール &gt; オプション を選択する。</p>\n<p data-sourcepos=\"5:1-5:121\"><a href=\"https://camo.qiitausercontent.com/ed9e6091c357e660d6186afa3094d609e1daa901/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f63353961363631392d653266642d656530662d313731342d6135316465643961343039352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fc59a6619-e2fd-ee0f-1714-a51ded9a4095.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3b196f071cd11113df857713fce65c90\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/c59a6619-e2fd-ee0f-1714-a51ded9a4095.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fc59a6619-e2fd-ee0f-1714-a51ded9a4095.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f8b0b7833f392469c8458c805ba1252e 1x\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"7:1-7:278\">② クエリ結果 &gt; SQL Server &gt; 全般 を選択し、「結果の既定の出力先(D)」を「結果をファイルに出力」に設定する。「クエリ結果の既定の保存先(E)」には、ファイルを保存するフォルダを設定し、OKを押下する。</p>\n<p data-sourcepos=\"9:1-9:121\"><a href=\"https://camo.qiitausercontent.com/5ab7689ea28c10553467d0ff287bc9873c1ab514/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f63666230666632362d623434662d383832662d353339362d6638336533396465653561382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fcfb0ff26-b44f-882f-5396-f83e39dee5a8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=fb6edd480d1e11b4e9a05f005750ab16\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/cfb0ff26-b44f-882f-5396-f83e39dee5a8.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fcfb0ff26-b44f-882f-5396-f83e39dee5a8.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ff552c8af7e5e6abd6a32778cc742a13 1x\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"11:1-11:161\">※1 後述しますが、入力したフォルダは既定の保存先にすぎません。実際にはSQL実行のたびにフォルダ選択が可能です。</p>\n<p data-sourcepos=\"13:1-13:116\">※2 クエリ結果 &gt; SQL Server &gt; 結果をテキストで表示 から 出力形式の細かい設定が可能。</p>\n<p data-sourcepos=\"15:1-15:121\"><a href=\"https://camo.qiitausercontent.com/d45226baeee359089e24292bd39599b9ad64f84c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f31346535323734652d376237312d626436352d666432652d6635346361306436613032302e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F14e5274e-7b71-bd65-fd2e-f54ca0d6a020.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=34cc37b1b4db966c9515d48e254c02b4\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/14e5274e-7b71-bd65-fd2e-f54ca0d6a020.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F14e5274e-7b71-bd65-fd2e-f54ca0d6a020.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9487a739c940d860a47c0b4e6a86d71e 1x\" loading=\"lazy\"></a></p>\n<hr data-sourcepos=\"17:1-18:0\">\n<p data-sourcepos=\"19:1-19:138\">設定が終わったので、実際に動かしてみましょう。ここでは例として、以下のようなSQLを実行します。</p>\n<p data-sourcepos=\"21:1-21:121\"><a href=\"https://camo.qiitausercontent.com/303f8737ac2c13871bad33acecd3c9842de5615e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f32393133653637352d613435332d333936652d326162372d3432373537343837626162352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F2913e675-a453-396e-2ab7-42757487bab5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3585450faf6ae7c40a0b62404d5d00c0\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/2913e675-a453-396e-2ab7-42757487bab5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F2913e675-a453-396e-2ab7-42757487bab5.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=922075d7588de90f1618f381791a42e6 1x\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"23:1-23:123\">SQL実行後、ファイルダイアログが開くので、任意の名前を入力し、ファイルを保存します。</p>\n<p data-sourcepos=\"25:1-25:121\"><a href=\"https://camo.qiitausercontent.com/6a8e58ad7da4b00b7cf538c0e5e9cc0586ae3231/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f65306565363266312d333530312d663564372d363734312d3632386463623435373432382e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fe0ee62f1-3501-f5d7-6741-628dcb457428.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=10ac4bc3f9bd0a027556ad09f9047bcc\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/e0ee62f1-3501-f5d7-6741-628dcb457428.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Fe0ee62f1-3501-f5d7-6741-628dcb457428.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3fb64b39392b00cb8afe033cf3b50e3e 1x\" loading=\"lazy\"></a></p>\n<p data-sourcepos=\"27:1-27:410\">ファイルの拡張子はrptとなっています。見慣れない拡張子ですが、<strong>実態は単なるフラットファイルです。</strong> そのため、任意のテキストエディタで中身を確認することが可能です。ここではsakuraエディタを使って、さきほどのファイルを確認すると、実行したSQLの結果が保存されていることがわかります。</p>\n<p data-sourcepos=\"29:1-29:121\"><a href=\"https://camo.qiitausercontent.com/d2e4b7ce3c436a3c54005b5d800f7a698cd218fb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f66396161396562612d336361312d373966362d366435372d3838663065313635613638372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Ff9aa9eba-3ca1-79f6-6d57-88f0e165a687.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=974eeb5c84c9dc357bc57cc9aa7078ce\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/f9aa9eba-3ca1-79f6-6d57-88f0e165a687.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2Ff9aa9eba-3ca1-79f6-6d57-88f0e165a687.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=483534fb337d3a825ae537a9203bb437 1x\" loading=\"lazy\"></a></p>\n<hr data-sourcepos=\"31:1-32:0\">\n<p data-sourcepos=\"33:1-33:17\"><strong>環境情報:</strong></p>\n<p data-sourcepos=\"35:1-35:128\"><a href=\"https://camo.qiitausercontent.com/71796f0063562ef161f54c73edb7083eb35d8271/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130353835392f37646235303237662d303237342d333363362d343266372d6338363539366562323638372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F7db5027f-0274-33c6-42f7-c86596eb2687.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a4c623bea964d1dec27c123126d9688f\" alt=\"SSMS_Version.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/7db5027f-0274-33c6-42f7-c86596eb2687.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F7db5027f-0274-33c6-42f7-c86596eb2687.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=7379225c810efae09db49ac5cd793ccb 1x\" loading=\"lazy\"></a></p>\n","body":"SSMSでクエリ結果をファイルに保存したい場合、以下の手順で設定を行います。\n\n① ツール > オプション を選択する。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/c59a6619-e2fd-ee0f-1714-a51ded9a4095.png)\n\n② クエリ結果 > SQL Server > 全般 を選択し、「結果の既定の出力先(D)」を「結果をファイルに出力」に設定する。「クエリ結果の既定の保存先(E)」には、ファイルを保存するフォルダを設定し、OKを押下する。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/cfb0ff26-b44f-882f-5396-f83e39dee5a8.png)\n\n※1 後述しますが、入力したフォルダは既定の保存先にすぎません。実際にはSQL実行のたびにフォルダ選択が可能です。\n\n※2 クエリ結果 > SQL Server > 結果をテキストで表示 から 出力形式の細かい設定が可能。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/14e5274e-7b71-bd65-fd2e-f54ca0d6a020.png)\n\n---\n\n設定が終わったので、実際に動かしてみましょう。ここでは例として、以下のようなSQLを実行します。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/2913e675-a453-396e-2ab7-42757487bab5.png)\n\nSQL実行後、ファイルダイアログが開くので、任意の名前を入力し、ファイルを保存します。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/e0ee62f1-3501-f5d7-6741-628dcb457428.png)\n\nファイルの拡張子はrptとなっています。見慣れない拡張子ですが、**実態は単なるフラットファイルです。** そのため、任意のテキストエディタで中身を確認することが可能です。ここではsakuraエディタを使って、さきほどのファイルを確認すると、実行したSQLの結果が保存されていることがわかります。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/f9aa9eba-3ca1-79f6-6d57-88f0e165a687.png)\n\n---\n\n__環境情報:__\n\n![SSMS_Version.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/7db5027f-0274-33c6-42f7-c86596eb2687.png)\n","coediting":false,"comments_count":0,"created_at":"2023-03-25T23:09:50+09:00","group":null,"id":"7a9fce64ff8ce6a9879f","likes_count":0,"private":false,"reactions_count":0,"stocks_count":0,"tags":[{"name":"SQLServer","versions":[]},{"name":"SSMS","versions":[]}],"title":"SSMSでクエリ結果をファイルに保存したい","updated_at":"2023-03-25T23:09:50+09:00","url":"https://qiita.com/neko_the_shadow/items/7a9fce64ff8ce6a9879f","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":36,"github_login_name":null,"id":"neko_the_shadow","items_count":214,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://github.com/nekoTheShadow"},"page_views_count":488,"team_membership":null,"organization_url_name":null}