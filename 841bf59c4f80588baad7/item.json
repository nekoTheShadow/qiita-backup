{"rendered_body":"<p>RHEL7/CentOS7上で開発や運用をしていると「Too many open files」「ファイルを開きすぎています」といったエラーが出ることがあります。これはファイルディスクリプタの枯渇が原因であり、その上限値を調整することが対策法となります。</p>\n\n<p>さて調査の結果、ファイルディスクリプタの上限値は<code>ulimit -n</code>により設定できることが分かったのですが――<strong><code>ulimit</code>による設定は一時的な効力しかなく、<code>reboot</code>や<code>shutdown</code>をすると、もともとの値に戻ってしまいます。</strong></p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre><code>[root@localhost ~]# ulimit -n\n1024\n[root@localhost ~]# ulimit -n 4096\n[root@localhost ~]# ulimit -n \n4096\n[root@localhost ~]# reboot \n\n=== 再起動後 === \n\n[root@localhost ~]# ulimit -n\n1024\n</code></pre></div></div>\n\n<p><code>shutdown</code>/<code>reboot</code>後も設定を維持したいという場合<code>/etc/security/limits.conf</code>という設定ファイルに以下のような記述をくわえます。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre><code>* soft nofile 4096\n* hard nofile 4096\n</code></pre></div></div>\n\n<p><code>/etc/security/limits.conf</code>には詳細な説明と凡例が掲載されているので、説明は割愛します。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre><code>[root@localhost ~]# vi /etc/security/limits.conf \n[root@localhost ~]# tail -n 5 /etc/security/limits.conf\n\n* soft nofile 4096\n* hard nofile 4096\n\n# End of file\n[root@localhost ~]# reboot\n\n=== 再起動後 ===\n\n[root@localhost ~]# ulimit -n\n4096\n</code></pre></div></div>\n","body":"RHEL7/CentOS7上で開発や運用をしていると「Too many open files」「ファイルを開きすぎています」といったエラーが出ることがあります。これはファイルディスクリプタの枯渇が原因であり、その上限値を調整することが対策法となります。\n\nさて調査の結果、ファイルディスクリプタの上限値は`ulimit -n`により設定できることが分かったのですが――__`ulimit`による設定は一時的な効力しかなく、`reboot`や`shutdown`をすると、もともとの値に戻ってしまいます。__\n\n```\n[root@localhost ~]# ulimit -n\n1024\n[root@localhost ~]# ulimit -n 4096\n[root@localhost ~]# ulimit -n \n4096\n[root@localhost ~]# reboot \n\n=== 再起動後 === \n\n[root@localhost ~]# ulimit -n\n1024\n```\n\n`shutdown`/`reboot`後も設定を維持したいという場合`/etc/security/limits.conf `という設定ファイルに以下のような記述をくわえます。\n\n```\n* soft nofile 4096\n* hard nofile 4096\n```\n\n`/etc/security/limits.conf `には詳細な説明と凡例が掲載されているので、説明は割愛します。\n\n```\n[root@localhost ~]# vi /etc/security/limits.conf \n[root@localhost ~]# tail -n 5 /etc/security/limits.conf\n\n* soft nofile 4096\n* hard nofile 4096\n\n# End of file\n[root@localhost ~]# reboot\n\n=== 再起動後 ===\n\n[root@localhost ~]# ulimit -n\n4096\n```\n","coediting":false,"comments_count":0,"created_at":"2018-01-17T00:51:45+09:00","group":null,"id":"841bf59c4f80588baad7","likes_count":3,"private":false,"reactions_count":0,"stocks_count":6,"tags":[{"name":"CentOS","versions":[]},{"name":"RHEL","versions":[]},{"name":"RHEL7","versions":[]},{"name":"centos7","versions":[]}],"title":"reboot/shutdown後も設定を維持したい場合はulimit -nではなく/etc/security/limits.confを編集する(「Too many open files」「ファイルを開きすぎています」エラー対策)","updated_at":"2018-01-17T00:51:45+09:00","url":"https://qiita.com/neko_the_shadow/items/841bf59c4f80588baad7","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":37,"github_login_name":null,"id":"neko_the_shadow","items_count":216,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://github.com/nekoTheShadow"},"page_views_count":17386,"team_membership":null,"organization_url_name":null,"slide":false}