[{"body":"@miyu さん:\n\nコメントありがとうございます。\n\nご指摘のとおり、`-n`と`-z`の説明がちょうど真逆でした。眠たいときに記事を書いてはいけませんね……反省。なおご指摘の点は修正いたしました。\n","created_at":"2016-11-21T22:30:35+09:00","id":"bd2b7775d75815c0f1ed","rendered_body":"<p><a href=\"/miyu\" class=\"user-mention js-hovercard\" title=\"miyu\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"miyu\">@miyu</a> さん:</p>\n\n<p>コメントありがとうございます。</p>\n\n<p>ご指摘のとおり、<code>-n</code>と<code>-z</code>の説明がちょうど真逆でした。眠たいときに記事を書いてはいけませんね……反省。なおご指摘の点は修正いたしました。</p>\n","updated_at":"2016-11-21T22:30:35+09:00","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":35,"github_login_name":null,"id":"neko_the_shadow","items_count":183,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"}},{"body":"`[` は `test` のショートハンドなので、 `man test` に説明があります。\n\n> -n STRING\n> 　　　　the length of STRING is nonzero\n> \n> STRING equivalent to -n STRING\n> \n> -z STRING\n> 　　　　the length of STRING is zero\n\n`-n` は \"**n**onzero\" からきています。\n\n`[` はコマンドですので、書き方次第では if ; then ; fi 構文不要です\n\n```bash\ndirectory=\"/hoge/hoge\"\n[ -z \"$(ls \"${directory}\")\" ] && rmdir \"${directory}\"\n```\n\n----\n\n> 次の例ではディレクトリが空かどうかをみて、空ならばそのディレクトリ直下にcsvファイルを配置するという処理を行っています。\n\nそれは、**「カラならば」**だから\n\n```bash\ndirectory=\"/foo/foo\"\nif [ -z \"$(ls \"${directory}\")\" ]; then\n    touch \"${directory}/foo.csv\"\nfi\n```\n\n---\n\nですがそもそも`ls`はこういう使い方をするためのプログラムではありません。\n（ **`.` で始まるファイルは `ls -A` でないと見えません！:scream:** ）\n\nですから 例えばfindutils を使うべきだと思います。\n\n```bash\nfind . -type d -empty -exec rmdir '{}' \\;\n```\n\n```bash\nfind /foo/foo -type d -empty -exec touch '{}'/foo.csv \\;\n```\n\nあるいは、書いていて自分でも自信がなくなってきますが:sweat:\n\n```bash\ndirectory=\"/foo/foo\" ; [ -d \"${directory}\" -a -w \"${directory}\" -a ! -e \"${directory}/\"* ] && touch \"${directory}/foo.csv\"\n```\n\n","created_at":"2016-11-21T15:57:58+09:00","id":"b1f1ecfd356ce69e284b","rendered_body":"<p><code>[</code> は <code>test</code> のショートハンドなので、 <code>man test</code> に説明があります。</p>\n\n<blockquote>\n<p>-n STRING<br>\n　　　　the length of STRING is nonzero</p>\n\n<p>STRING equivalent to -n STRING</p>\n\n<p>-z STRING<br>\n　　　　the length of STRING is zero</p>\n</blockquote>\n\n<p><code>-n</code> は \"<strong>n</strong>onzero\" からきています。</p>\n\n<p><code>[</code> はコマンドですので、書き方次第では if ; then ; fi 構文不要です</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre class=\"with-code\"><code><span class=\"nv\">directory</span><span class=\"o\">=</span><span class=\"s2\">\"/hoge/hoge\"</span>\n<span class=\"o\">[</span> <span class=\"nt\">-z</span> <span class=\"s2\">\"</span><span class=\"si\">$(</span><span class=\"nb\">ls</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">\"</span><span class=\"si\">)</span><span class=\"s2\">\"</span> <span class=\"o\">]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">rmdir</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">\"</span>\n</code></pre></div></div>\n\n<hr>\n\n<blockquote>\n<p>次の例ではディレクトリが空かどうかをみて、空ならばそのディレクトリ直下にcsvファイルを配置するという処理を行っています。</p>\n</blockquote>\n\n<p>それは、<strong>「カラならば」</strong>だから</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre class=\"with-code\"><code><span class=\"nv\">directory</span><span class=\"o\">=</span><span class=\"s2\">\"/foo/foo\"</span>\n<span class=\"k\">if</span> <span class=\"o\">[</span> <span class=\"nt\">-z</span> <span class=\"s2\">\"</span><span class=\"si\">$(</span><span class=\"nb\">ls</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">\"</span><span class=\"si\">)</span><span class=\"s2\">\"</span> <span class=\"o\">]</span><span class=\"p\">;</span> <span class=\"k\">then\n    </span><span class=\"nb\">touch</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">/foo.csv\"</span>\n<span class=\"k\">fi</span>\n</code></pre></div></div>\n\n<hr>\n\n<p>ですがそもそも<code>ls</code>はこういう使い方をするためのプログラムではありません。<br>\n（ <strong><code>.</code> で始まるファイルは <code>ls -A</code> でないと見えません！<img alt=\":scream:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f631.png\" title=\":scream:\" width=\"20\" loading=\"lazy\"></strong> ）</p>\n\n<p>ですから 例えばfindutils を使うべきだと思います。</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre class=\"with-code\"><code>find <span class=\"nb\">.</span> <span class=\"nt\">-type</span> d <span class=\"nt\">-empty</span> <span class=\"nt\">-exec</span> <span class=\"nb\">rmdir</span> <span class=\"s1\">'{}'</span> <span class=\"se\">\\;</span>\n</code></pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre class=\"with-code\"><code>find /foo/foo <span class=\"nt\">-type</span> d <span class=\"nt\">-empty</span> <span class=\"nt\">-exec</span> <span class=\"nb\">touch</span> <span class=\"s1\">'{}'</span>/foo.csv <span class=\"se\">\\;</span>\n</code></pre></div></div>\n\n<p>あるいは、書いていて自分でも自信がなくなってきますが<img alt=\":sweat:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f613.png\" title=\":sweat:\" width=\"20\" loading=\"lazy\"></p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre class=\"with-code\"><code><span class=\"nv\">directory</span><span class=\"o\">=</span><span class=\"s2\">\"/foo/foo\"</span> <span class=\"p\">;</span> <span class=\"o\">[</span> <span class=\"nt\">-d</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"nt\">-a</span> <span class=\"nt\">-w</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"nt\">-a</span> <span class=\"o\">!</span> <span class=\"nt\">-e</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">/\"</span><span class=\"k\">*</span> <span class=\"o\">]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">touch</span> <span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">directory</span><span class=\"k\">}</span><span class=\"s2\">/foo.csv\"</span>\n</code></pre></div></div>\n","updated_at":"2016-11-21T15:57:58+09:00","user":{"description":"","facebook_id":"","followees_count":3,"followers_count":21,"github_login_name":null,"id":"miyu","items_count":14,"linkedin_id":"","location":"","name":"","organization":"self-employed","permanent_id":103185,"profile_image_url":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/103185/profile-images/1618803200","team_only":false,"twitter_screen_name":null,"website_url":""}}]