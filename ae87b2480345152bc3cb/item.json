{"rendered_body":"<p>Docker Desktop backend WSL2 をインストールすると、docker-desktopとdocker-desktop-dataというふたつのディストリビューションが作成されます。</p>\n\n<table>\n<thead>\n<tr>\n<th>ディストリビューション</th>\n<th>役割</th>\n<th>実体(デフォルト)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>docker-desktop</td>\n<td>Dockerを動かすためのエンジン</td>\n<td>%LocalAppData%\\Docker\\wsl\\data\\ext4.vhdx</td>\n</tr>\n<tr>\n<td>docker-desktop-data</td>\n<td>イメージやコンテナを格納する</td>\n<td>%LocalAppData%\\Docker\\wsl\\distro\\ext4.vhdx</td>\n</tr>\n</tbody>\n</table>\n\n<p>とくにdocker-desktop-dataについては、<code>docker pull</code>などを繰り返すたびにもりもり大きくなっていくため、<code>%LocalAppData%</code>に置いておきたくない、ドライブごと変えてしまいたいということが十分ありえます。</p>\n\n<p><strong>そこで本記事ではdocker-desktopとdocker-desktop-dataの実体である<code>ext4.vhdx</code>を別の場所に移動させる方法については記述します。ここでは例として、docker-desktopの<code>ext4.vhdx</code>を<code>D:\\wsl\\docker-desktop</code>に、docker-desktop-dataの<code>ext4.vhdx</code>を<code>D:\\wsl\\docker-desktop-data</code>にそれぞれ移動させたいと思います。</strong></p>\n\n<h3>\n<span id=\"1-docker-desktopの停止\" class=\"fragment\"></span><a href=\"#1-docker-desktop%E3%81%AE%E5%81%9C%E6%AD%A2\"><i class=\"fa fa-link\"></i></a>1. Docker Desktopの停止</h3>\n\n<p>タスクトレイのDockerマークを右クリックし、<code>Quit Docker Desktop</code>を押下する。</p>\n\n<h3>\n<span id=\"2-ディストリビューションのエクスポート\" class=\"fragment\"></span><a href=\"#2-%E3%83%87%E3%82%A3%E3%82%B9%E3%83%88%E3%83%AA%E3%83%93%E3%83%A5%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88\"><i class=\"fa fa-link\"></i></a>2. ディストリビューションのエクスポート</h3>\n\n<p>ディストリビューションをtarファイルにエクスポートする。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>wsl --export docker-desktop docker-desktop.tar\nwsl --export docker-desktop-data docker-desktop-data.tar\n</pre></div></div>\n\n<h3>\n<span id=\"3-ディストリビューションの削除\" class=\"fragment\"></span><a href=\"#3-%E3%83%87%E3%82%A3%E3%82%B9%E3%83%88%E3%83%AA%E3%83%93%E3%83%A5%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E5%89%8A%E9%99%A4\"><i class=\"fa fa-link\"></i></a>3. ディストリビューションの削除</h3>\n\n<p>ここでdocker-desktopとdocker-desktop-dataをいったん削除します。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>wsl --unregister docker-desktop\nwsl --unregister docker-desktop-data \n</pre></div></div>\n\n<h3>\n<span id=\"4-ディストリビューションのインポート\" class=\"fragment\"></span><a href=\"#4-%E3%83%87%E3%82%A3%E3%82%B9%E3%83%88%E3%83%AA%E3%83%93%E3%83%A5%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88\"><i class=\"fa fa-link\"></i></a>4. ディストリビューションのインポート</h3>\n\n<p>2.でエクスポートしたtarファイルを入力に、ディストリビューションの再インポートを行います。このとき、<code>ext4.vhdx</code>の移動先となるフォルダを必ず指定します。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>wsl --import docker-desktop D:\\wsl\\docker-desktop docker-desktop.tar\nwsl --import docker-desktop-data D:\\wsl\\docker-desktop-data docker-desktop-data.tar\n</pre></div></div>\n\n<h3>\n<span id=\"5-docker-desktopの起動\" class=\"fragment\"></span><a href=\"#5-docker-desktop%E3%81%AE%E8%B5%B7%E5%8B%95\"><i class=\"fa fa-link\"></i></a>5. Docker Desktopの起動</h3>\n\n<p>最後に任意の方法でDocker Desktopを起動させれば完了になります。</p>\n\n<h1>\n<span id=\"環境情報\" class=\"fragment\"></span><a href=\"#%E7%92%B0%E5%A2%83%E6%83%85%E5%A0%B1\"><i class=\"fa fa-link\"></i></a>環境情報</h1>\n\n<ul>\n<li>Dockerのバージョン:</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>C:\\&gt;docker version\nClient: Docker Engine - Community\n Version:           19.03.8\n API version:       1.40\n Go version:        go1.12.17\n Git commit:        afacb8b\n Built:             Wed Mar 11 01:23:10 2020\n OS/Arch:           windows/amd64\n Experimental:      false\n\nServer: Docker Engine - Community\n Engine:\n  Version:          19.03.8\n  API version:      1.40 (minimum version 1.12)\n  Go version:       go1.12.17\n  Git commit:       afacb8b\n  Built:            Wed Mar 11 01:29:16 2020\n  OS/Arch:          linux/amd64\n  Experimental:     false\n containerd:\n  Version:          v1.2.13\n  GitCommit:        7ad184331fa3e55e52b890ea95e65ba581ae3429\n runc:\n  Version:          1.0.0-rc10\n  GitCommit:        dc9208a3303feef5b3839f4323d9beb36df0a9dd\n docker-init:\n  Version:          0.18.0\n  GitCommit:        fec3683\n</pre></div></div>\n\n<ul>\n<li>Windowsのバージョン:</li>\n</ul>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F65cc0ad4-785d-8006-8716-b7ec8dac151b.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f94ae4595255e7b8b54ca90f760e2cc0\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F65cc0ad4-785d-8006-8716-b7ec8dac151b.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f94ae4595255e7b8b54ca90f760e2cc0\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/65cc0ad4-785d-8006-8716-b7ec8dac151b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F105859%2F65cc0ad4-785d-8006-8716-b7ec8dac151b.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=dffcc2b99ed311813a507280314973d1 1x\" loading=\"lazy\"></a></p>\n","body":"Docker Desktop backend WSL2 をインストールすると、docker-desktopとdocker-desktop-dataというふたつのディストリビューションが作成されます。\n\n|ディストリビューション|役割|実体(デフォルト)|\n|---|---|---|\n|docker-desktop|Dockerを動かすためのエンジン|%LocalAppData%\\Docker\\wsl\\data\\ext4.vhdx|\n|docker-desktop-data|イメージやコンテナを格納する|%LocalAppData%\\Docker\\wsl\\distro\\ext4.vhdx|\n\nとくにdocker-desktop-dataについては、`docker pull`などを繰り返すたびにもりもり大きくなっていくため、`%LocalAppData%`に置いておきたくない、ドライブごと変えてしまいたいということが十分ありえます。\n\n__そこで本記事ではdocker-desktopとdocker-desktop-dataの実体である`ext4.vhdx`を別の場所に移動させる方法については記述します。ここでは例として、docker-desktopの`ext4.vhdx`を`D:\\wsl\\docker-desktop`に、docker-desktop-dataの`ext4.vhdx`を`D:\\wsl\\docker-desktop-data`にそれぞれ移動させたいと思います。__\n\n### 1. Docker Desktopの停止\n\nタスクトレイのDockerマークを右クリックし、`Quit Docker Desktop`を押下する。\n\n### 2. ディストリビューションのエクスポート\n\nディストリビューションをtarファイルにエクスポートする。\n\n```\nwsl --export docker-desktop docker-desktop.tar\nwsl --export docker-desktop-data docker-desktop-data.tar\n```\n\n### 3. ディストリビューションの削除\n\nここでdocker-desktopとdocker-desktop-dataをいったん削除します。\n\n```\nwsl --unregister docker-desktop\nwsl --unregister docker-desktop-data \n```\n\n### 4. ディストリビューションのインポート\n\n2.でエクスポートしたtarファイルを入力に、ディストリビューションの再インポートを行います。このとき、`ext4.vhdx`の移動先となるフォルダを必ず指定します。\n\n```\nwsl --import docker-desktop D:\\wsl\\docker-desktop docker-desktop.tar\nwsl --import docker-desktop-data D:\\wsl\\docker-desktop-data docker-desktop-data.tar\n```\n\n### 5. Docker Desktopの起動\n\n最後に任意の方法でDocker Desktopを起動させれば完了になります。\n\n# 環境情報\n\n- Dockerのバージョン:\n\n```\nC:\\>docker version\nClient: Docker Engine - Community\n Version:           19.03.8\n API version:       1.40\n Go version:        go1.12.17\n Git commit:        afacb8b\n Built:             Wed Mar 11 01:23:10 2020\n OS/Arch:           windows/amd64\n Experimental:      false\n\nServer: Docker Engine - Community\n Engine:\n  Version:          19.03.8\n  API version:      1.40 (minimum version 1.12)\n  Go version:       go1.12.17\n  Git commit:       afacb8b\n  Built:            Wed Mar 11 01:29:16 2020\n  OS/Arch:          linux/amd64\n  Experimental:     false\n containerd:\n  Version:          v1.2.13\n  GitCommit:        7ad184331fa3e55e52b890ea95e65ba581ae3429\n runc:\n  Version:          1.0.0-rc10\n  GitCommit:        dc9208a3303feef5b3839f4323d9beb36df0a9dd\n docker-init:\n  Version:          0.18.0\n  GitCommit:        fec3683\n```\n\n- Windowsのバージョン:\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/105859/65cc0ad4-785d-8006-8716-b7ec8dac151b.png)\n\n","coediting":false,"comments_count":0,"created_at":"2020-06-21T02:24:47+09:00","group":null,"id":"ae87b2480345152bc3cb","likes_count":33,"private":false,"reactions_count":0,"tags":[{"name":"Docker","versions":[]},{"name":"WSL2","versions":[]}],"title":"WSL2 Dockerのイメージ・コンテナの格納先を変更したい (WSL2のvhdxファイルを移動させたい)","updated_at":"2020-06-21T02:24:47+09:00","url":"https://qiita.com/neko_the_shadow/items/ae87b2480345152bc3cb","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":33,"github_login_name":null,"id":"neko_the_shadow","items_count":171,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null}