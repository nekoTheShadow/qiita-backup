{"rendered_body":"<p><a href=\"https://codeiq.jp/q/2833\" rel=\"nofollow noopener\" target=\"_blank\">CodeIQ「『トライアングル・メイズ』問題」</a>の掲載期間が終了したということで、自分が提出したコード(Python3)を公開します。<a href=\"http://togetter.com/li/1031276\" rel=\"nofollow noopener\" target=\"_blank\">ほかの解答者のコードはTogetterにまとめらています</a>ので、そちらもぜひ。</p>\n\n<div class=\"code-frame\" data-lang=\"py3\"><div class=\"highlight\"><pre>\n<span class=\"s\">\"\"\"\n「『トライアングル・メイズ』問題」の解答コード。\n\n1. 漸化式はF(n + 1) = F(n) * (F(n) + 1)\n2. F(n) mod 1000003, F(n + 1) mod 1000003, ... が「繰り返し」を持つことを利用する\n\"\"\"</span>\n\n<span class=\"k\">if</span> <span class=\"n\">__name__</span> <span class=\"o\">==</span> <span class=\"s\">'__main__'</span><span class=\"p\">:</span>\n    <span class=\"n\">ls</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">ht</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n    <span class=\"c1\"># n=0からF(n)の値を探索しlsに記録する。\n</span>    <span class=\"c1\"># 「繰り返し」が現れた時点で探索を終了してもよい。\n</span>    <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">10000003</span><span class=\"p\">):</span>\n        <span class=\"n\">t</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">ls</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"n\">ls</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">ls</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span> <span class=\"o\">%</span> <span class=\"mi\">1000003</span>\n        <span class=\"k\">if</span> <span class=\"n\">t</span> <span class=\"ow\">in</span> <span class=\"n\">ht</span><span class=\"p\">:</span> <span class=\"k\">break</span>\n\n        <span class=\"n\">ls</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">t</span><span class=\"p\">)</span>\n        <span class=\"n\">ht</span><span class=\"p\">[</span><span class=\"n\">t</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">i</span>\n\n    <span class=\"c1\"># 「繰り返し」の開始地点と終了地点を探す\n</span>    <span class=\"n\">start</span> <span class=\"o\">=</span> <span class=\"n\">ht</span><span class=\"p\">[(</span><span class=\"n\">ls</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"n\">ls</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">ls</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span> <span class=\"o\">%</span> <span class=\"mi\">1000003</span><span class=\"p\">]</span>\n    <span class=\"n\">end</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">ls</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"mi\">1</span>\n\n    <span class=\"c1\"># F(n)の値を計算し、出力する。\n</span>    <span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"nb\">input</span><span class=\"p\">())</span>\n    <span class=\"k\">if</span> <span class=\"n\">end</span> <span class=\"o\">&lt;</span> <span class=\"n\">n</span><span class=\"p\">:</span> <span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">n</span> <span class=\"o\">-</span> <span class=\"n\">start</span><span class=\"p\">)</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">end</span> <span class=\"o\">+</span> <span class=\"mi\">1</span> <span class=\"o\">-</span> <span class=\"n\">start</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"n\">start</span>\n\n    <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">ls</span><span class=\"p\">[</span><span class=\"n\">n</span><span class=\"p\">])</span>\n\n</pre></div></div>\n\n<p>さて感想ですが、漸化式$F(n + 1) = F(n) * (F(n) + 1)$と「繰り返し」のふたつに気がつけば溶ける問題だったように思います。漸化式についてはシンプルで気が付きやすいものでしたし、サンプルに挙げられた値をGoogle検索すればOEISがヒットした記憶もあります(肝心のページは失念)。また「100003でわったあまりを求めなさい」という指示から「繰り返し」も連想しやすかったと思います。</p>\n","body":"\n[CodeIQ「『トライアングル・メイズ』問題」](https://codeiq.jp/q/2833)の掲載期間が終了したということで、自分が提出したコード(Python3)を公開します。[ほかの解答者のコードはTogetterにまとめらています](http://togetter.com/li/1031276)ので、そちらもぜひ。\n\n\n```py3\n\n\"\"\"\n「『トライアングル・メイズ』問題」の解答コード。\n\n1. 漸化式はF(n + 1) = F(n) * (F(n) + 1)\n2. F(n) mod 1000003, F(n + 1) mod 1000003, ... が「繰り返し」を持つことを利用する\n\"\"\"\n\nif __name__ == '__main__':\n    ls = [0, 1]\n    ht = {}\n\n    # n=0からF(n)の値を探索しlsに記録する。\n    # 「繰り返し」が現れた時点で探索を終了してもよい。\n    for i in range(2, 10000003):\n        t = (ls[-1] * ls[-1] + ls[-1]) % 1000003\n        if t in ht: break\n\n        ls.append(t)\n        ht[t] = i\n    \n    # 「繰り返し」の開始地点と終了地点を探す\n    start = ht[(ls[-1] * ls[-1] + ls[-1]) % 1000003]\n    end = len(ls) - 1\n\n    # F(n)の値を計算し、出力する。\n    n = int(input())\n    if end < n: n = (n - start) % (end + 1 - start) + start\n    \n    print(ls[n])\n\n```\n\nさて感想ですが、漸化式$F(n + 1) = F(n) * (F(n) + 1)$と「繰り返し」のふたつに気がつけば溶ける問題だったように思います。漸化式についてはシンプルで気が付きやすいものでしたし、サンプルに挙げられた値をGoogle検索すればOEISがヒットした記憶もあります(肝心のページは失念)。また「100003でわったあまりを求めなさい」という指示から「繰り返し」も連想しやすかったと思います。\n","coediting":false,"comments_count":0,"created_at":"2016-10-01T09:01:17+09:00","group":null,"id":"952a0c103a0bfc432963","likes_count":0,"private":false,"reactions_count":0,"tags":[{"name":"codeiq","versions":[]},{"name":"Python3","versions":[]}],"title":"CodeIQ「『トライアングル・メイズ』問題」に参加しました。","updated_at":"2016-10-01T09:13:48+09:00","url":"https://qiita.com/neko_the_shadow/items/952a0c103a0bfc432963","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":35,"github_login_name":null,"id":"neko_the_shadow","items_count":173,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null}