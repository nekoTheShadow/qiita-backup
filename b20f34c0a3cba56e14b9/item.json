{"rendered_body":"<p>Excelにはシートをソートする機能は標準で用意されていません。通常はVBAを利用するのですが、VBAにはソート関数がなく、これを自前を用意するのは面倒。そもそもVBAが苦手ということもあり、JavaとApache POIで処理したことがこの記事を書いたきっかけになります。</p>\n\n<p>前置きはさておき、以下は「<strong>src.xlsxのシートをシート名でソートしたものをdst.xlsxに書き出す</strong>」というものです。</p>\n\n<div class=\"code-frame\" data-lang=\"java\"><div class=\"highlight\"><pre><code><span class=\"k\">try</span> <span class=\"o\">(</span><span class=\"nc\">Workbook</span> <span class=\"n\">srcWorkBook</span> <span class=\"o\">=</span> <span class=\"nc\">WorkbookFactory</span><span class=\"o\">.</span><span class=\"na\">create</span><span class=\"o\">(</span><span class=\"nc\">Files</span><span class=\"o\">.</span><span class=\"na\">newInputStream</span><span class=\"o\">(</span><span class=\"nc\">Paths</span><span class=\"o\">.</span><span class=\"na\">get</span><span class=\"o\">(</span><span class=\"s\">\"src.xlsx\"</span><span class=\"o\">)));</span>\n     <span class=\"nc\">OutputStream</span> <span class=\"n\">dstWorkBook</span> <span class=\"o\">=</span> <span class=\"nc\">Files</span><span class=\"o\">.</span><span class=\"na\">newOutputStream</span><span class=\"o\">(</span><span class=\"nc\">Paths</span><span class=\"o\">.</span><span class=\"na\">get</span><span class=\"o\">(</span><span class=\"s\">\"dst.xlsx\"</span><span class=\"o\">)))</span> <span class=\"o\">{</span>\n\n    <span class=\"nc\">List</span><span class=\"o\">&lt;</span><span class=\"nc\">String</span><span class=\"o\">&gt;</span> <span class=\"n\">sheetNames</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nc\">ArrayList</span><span class=\"o\">&lt;&gt;();</span>\n    <span class=\"k\">for</span> <span class=\"o\">(</span><span class=\"nc\">Sheet</span> <span class=\"n\">sheet</span> <span class=\"o\">:</span> <span class=\"n\">srcWorkBook</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n        <span class=\"n\">sheetNames</span><span class=\"o\">.</span><span class=\"na\">add</span><span class=\"o\">(</span><span class=\"n\">sheet</span><span class=\"o\">.</span><span class=\"na\">getSheetName</span><span class=\"o\">());</span>\n    <span class=\"o\">}</span>\n\n    <span class=\"nc\">Collections</span><span class=\"o\">.</span><span class=\"na\">sort</span><span class=\"o\">(</span><span class=\"n\">sheetNames</span><span class=\"o\">);</span>\n    <span class=\"k\">for</span> <span class=\"o\">(</span><span class=\"kt\">int</span> <span class=\"n\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">len</span> <span class=\"o\">=</span> <span class=\"n\">sheetNames</span><span class=\"o\">.</span><span class=\"na\">size</span><span class=\"o\">();</span> <span class=\"n\">i</span> <span class=\"o\">&lt;</span> <span class=\"n\">len</span><span class=\"o\">;</span> <span class=\"n\">i</span><span class=\"o\">++)</span> <span class=\"o\">{</span>\n        <span class=\"n\">srcWorkBook</span><span class=\"o\">.</span><span class=\"na\">setSheetOrder</span><span class=\"o\">(</span><span class=\"n\">sheetNames</span><span class=\"o\">.</span><span class=\"na\">get</span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"o\">),</span> <span class=\"n\">i</span><span class=\"o\">);</span>\n    <span class=\"o\">}</span>\n\n    <span class=\"n\">srcWorkBook</span><span class=\"o\">.</span><span class=\"na\">write</span><span class=\"o\">(</span><span class=\"n\">dstWorkBook</span><span class=\"o\">);</span>\n<span class=\"o\">}</span> <span class=\"k\">catch</span> <span class=\"o\">(</span><span class=\"nc\">IOException</span> <span class=\"n\">e</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n    <span class=\"k\">throw</span> <span class=\"k\">new</span> <span class=\"nf\">UncheckedIOException</span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"o\">);</span>\n<span class=\"o\">}</span>\n</code></pre></div></div>\n\n<p><strong>環境情報 (pom.xmlの抜粋)</strong></p>\n\n<div class=\"code-frame\" data-lang=\"xml\"><div class=\"highlight\"><pre><code><span class=\"nt\">&lt;dependency&gt;</span>\n    <span class=\"nt\">&lt;groupId&gt;</span>org.apache.poi<span class=\"nt\">&lt;/groupId&gt;</span>\n    <span class=\"nt\">&lt;artifactId&gt;</span>poi<span class=\"nt\">&lt;/artifactId&gt;</span>\n    <span class=\"nt\">&lt;version&gt;</span>5.0.0<span class=\"nt\">&lt;/version&gt;</span>\n<span class=\"nt\">&lt;/dependency&gt;</span>\n<span class=\"nt\">&lt;dependency&gt;</span>\n    <span class=\"nt\">&lt;groupId&gt;</span>org.apache.poi<span class=\"nt\">&lt;/groupId&gt;</span>\n    <span class=\"nt\">&lt;artifactId&gt;</span>poi-ooxml<span class=\"nt\">&lt;/artifactId&gt;</span>\n    <span class=\"nt\">&lt;version&gt;</span>5.0.0<span class=\"nt\">&lt;/version&gt;</span>\n<span class=\"nt\">&lt;/dependency&gt;</span>\n</code></pre></div></div>\n","body":"Excelにはシートをソートする機能は標準で用意されていません。通常はVBAを利用するのですが、VBAにはソート関数がなく、これを自前を用意するのは面倒。そもそもVBAが苦手ということもあり、JavaとApache POIで処理したことがこの記事を書いたきっかけになります。\n\n前置きはさておき、以下は「**src.xlsxのシートをシート名でソートしたものをdst.xlsxに書き出す**」というものです。\n\n```java\ntry (Workbook srcWorkBook = WorkbookFactory.create(Files.newInputStream(Paths.get(\"src.xlsx\")));\n     OutputStream dstWorkBook = Files.newOutputStream(Paths.get(\"dst.xlsx\"))) {\n    \n    List<String> sheetNames = new ArrayList<>();\n    for (Sheet sheet : srcWorkBook) {\n        sheetNames.add(sheet.getSheetName());\n    }\n    \n    Collections.sort(sheetNames);\n    for (int i = 0, len = sheetNames.size(); i < len; i++) {\n        srcWorkBook.setSheetOrder(sheetNames.get(i), i);\n    }\n    \n    srcWorkBook.write(dstWorkBook);\n} catch (IOException e) {\n    throw new UncheckedIOException(e);\n}\n```\n\n**環境情報 (pom.xmlの抜粋)**\n\n```xml\n<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi</artifactId>\n    <version>5.0.0</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi-ooxml</artifactId>\n    <version>5.0.0</version>\n</dependency>\n```\n\n","coediting":false,"comments_count":0,"created_at":"2021-10-31T20:33:50+09:00","group":null,"id":"b20f34c0a3cba56e14b9","likes_count":0,"private":false,"reactions_count":0,"tags":[{"name":"Java","versions":[]},{"name":"POI","versions":[]}],"title":"Apache POIを使って、シートをソートしたい","updated_at":"2021-10-31T20:35:38+09:00","url":"https://qiita.com/neko_the_shadow/items/b20f34c0a3cba56e14b9","user":{"description":"IT業界の片隅でひっそり生きるシステムエンジニアです(´・ω・｀)","facebook_id":"","followees_count":0,"followers_count":36,"github_login_name":null,"id":"neko_the_shadow","items_count":197,"linkedin_id":"","location":"神奈川県川崎市","name":"","organization":"","permanent_id":105859,"profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/105859/profile-images/1473709753","team_only":false,"twitter_screen_name":"neko_the_shadow","website_url":"https://nekotheshadow.github.io/"},"page_views_count":null,"team_membership":null}